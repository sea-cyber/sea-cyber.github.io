<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="main.css">
    <script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=GPuduLUQQqP1T65OaDUA24tUftwKbRnb"></script>
    <script src="imageturns.js"></script>
    <script src="login.js"></script>
    <title>徐州市房地产信息服务系统</title>
    <style>
    </style>
</head>
<body>
    <!-- 页面首端导航栏 -->
    <div class="head">
        <div class="tltle"></div>
     <ul class="headnav">
        <li><a href="index.html">首页</a></li>
        <li><a href="list.html">房源</a></li>
        <li><a href="./可视化/01.html">可视化</a></li>
        <li><a href="mapsearch.html">地图找房</a></li>
     </ul>
     <ul class="headnav2" >
        <!-- <li id="login" >未登录</li> -->
        <!-- 更多下面是设置，个人中心，注销账户 -->
        <li class="more">头像
          <ul>  
            <li id="login" onclick="show()">登录</li>
            <li><a href="individual.html">个人中心</a></li>
           
          </ul>
        </li>
     </ul>
    </div>
    <!-- 登录页面 -->
    <div id="loginbox">
      <div class="signbox_main" id="signbox_main" >
          <div class="title">welcome come to here</div>
          <div class="login_list"> 
              <li onclick="loginisvisual()">登录</li> 
              <li onclick="signisvisual()">注册</li>
         </div>  
      
      <div class="loginbox_main_input">
           <div><input type="text"  placeholder="    请输入手机号或邮箱" class="name"  id="sign_acount"></div>  
           <!-- <div><input type="email" placeholder="    请输入邮箱" class="password"></div>  -->
           <div><input type="email" placeholder="    请输入密码" class="password"  id="sign_password"></div> 
           <div><input type="text" placeholder="    确认密码" class="password"    id="sign_fonfirm_password"></div>
        <div class="loginbox_main_forget">
          <a href="#"  onclick="forgotname()">忘记密码？</a>
          </div>
          <button onclick="sign()">注册</button>
          </div>
          <div id="cancel_login" onclick="cancellogin()">取消</div>
      </div>
  
  <div class="loginbox_main"  id="loginbox_main">
      <div class="title">welcome come to here</div>
      <div class="login_list"> 
          <li onclick="loginisvisual()">登录</li> 
          <li onclick="signisvisual()">注册</li>
         
       </div>
  
  <div class="loginbox_main_input">
  <div><input type="text" placeholder="    请输入手机号或邮箱" class="name" id="login_acount"></div>  
  <div><input type="text" placeholder="    请输入密码" class="password"  id="login_password"></div> 
      <div class="loginbox_main_forget">
          <a href="#"  onclick="forgotname()">忘记密码？</a>
      </div>
      <button onclick="login()">登录</button>
  </div>
         <div id="cancel_login" onclick="cancellogin()">取消</div>
</div> 

<div class="change_password_main"  id="change_password_main">
  <div class="title">welcome come to here</div>
  <div class="login_list"> 
      <li onclick="loginisvisual()">登录</li> 
      <li onclick="signisvisual()">注册</li>
     
   </div>

<div class="loginbox_main_input" >  
<div><input type="text"   placeholder="      请输入手机或邮箱"    class="name"          id="change_acount">      </div>  
<div><input type="submit" placeholder="      请输入用户名"        class="password" value="发送验证码" id="change_sendcode">  </div> 
<div><input type="text" placeholder="      请输入验证码"        class="password"  id="change_checkcode">  </div> 
<div><input type="text"   placeholder="      请输入密码"          class="name" id="change_password" >      </div>  
<div><input type="text"   placeholder="      请确认新密码"      class="password" id="change_confirmpasssword"> </div> 
  <div class="loginbox_main_forget">
      <a href="#"  onclick="forgotname()">忘记密码？</a>
  </div>
  <button onclick="changepassword()">修改密码</button>
</div>
     <div id="cancel_login" onclick="cancellogin()">取消</div>
</div>

  <div class="loginbox_img" >
      <img src="./housesystem/img/1.png" alt=""> 
  </div>
</div>
      <!-- 页面主体-->
      <div class="body">
        <!-- 左侧的div放房产信息列表 -->
        <!-- 右侧地图信息展示 -->
        <div id="bdmap-contaniner"></div>
        <div class="mapsearch"> 
            <!-- 这里是一些所搜条件，功能群， -->
            <!-- 使用绝对定位 -->
            <div class="mapsearch_search">
                <input type="text" placeholder="请输入..." class="mapsearch_input">
                <button class="mapsearch_btn">搜索</button>
            </div>
            <div class="mapsearch_clarify">
                <!-- 地点，新房以及旧房 ，-->
                <select name="地点" id="select_house_region"  onchange="selectChange(this)">
               
                    <option value="铜山区">铜山区</option>
                    <option value="云龙区">云龙区</option>
                    <option value="鼓楼区">鼓楼区</option>
                    <option value="泉山区">泉山区</option>
                    <option value="贾汪区">贾汪区</option>
                    <option value="新城区">新城区</option>
                    <option value="沛县">沛县</option>
                    <option value="丰县区">丰县区</option>

                    <option value=""></option>
                </select>
                   
                    <select name="房型" id="select_house_sort"  onchange="selectChange(this)">
                    <option value="oldhouse">旧房</option>
                    <option value="newhouse">新房</option>
                </select>
                <select name="户型" id="select_house_type"  onchange="selectChange(this)">
                
                    <option value="1">一室</option>
                    <option value="2">二室</option>
                    <option value="3">三室</option>
                    <option value="4">更多</option>
                </select>

            </div>
            <div class="mapsearch_gisgroup">
                <!-- 点击显示功能群的框 -->
                <ul>
                    <li onclick="gisgrouproadisvisual()">路径查询</li>
                    <li onclick="gisgrouprecentisvisual()">周边查询</li>
                    <li>更多</li>
                </ul>
            </div>
            <div class="mapsearch_gisgroup_recent"  id="mapsearch_gisgroup_recent"> 
              <div class="gisgroup_recent_if" >
              <div class="gisgroup_recent_center">查询中心:  <button>点击地图选择</button></div>  
              <div class="gisgroup_recent_select" > 
                目标:  <select name="" id="gisgroup_recent_goal">
                    <option value="医院">医院</option>
                    <option value="银行">银行</option>
                    <option value="地铁">地铁</option>
                    <option value="学校">学校</option>
                    <option value="超市">超市</option>
                    <option value="更多">更多</option>
                  </select>
                  距离:  <select name="" id="gisgroup_recent_distance">
                    <option value="1000">1km</option>
                    <option value="2000">2km</option>
                    <option value="3000">3km</option>
                    <option value="4000">4km</option>
                    <option value="5000">5km</option>
                  </select> 
                 </div>
               
              </div> 
              <button id="gisgroup_recent_btn">搜 索</button>
            <div id="gisgroup_recent_result">
              <h3>没有搜索结果</h1>
            </div>
          </div>
            
            <div class="mapsearch_gisgroup_road"  id="mapsearch_gisgroup_road"> 
              <div class="gisgroup_road_if" >
              <div class="gisgroup_road_center">
                出行方式:  <select name="" id="gisgroup_road_transform">
                  <option value="car">驾车</option>
                  <option value="bus">公交</option>
                  <!-- <option value="地铁">地铁</option> -->
                  <option value="step">步行</option>
                 
                </select></div>  
              <div class="gisgroup_road_select" > 
                起点:  <input type="text" name="" id="gisgroup_road_begin" value="矿大南湖校区">
                  终点:  <input type="text" name="" id="gisgroup_road_end" value="矿大文昌校区">
                 </div>
               
              </div> 
              <button id="gisgroup_road_btn"  cl>搜 索</button>
            </div>
        </div>
      </div>
      <!-- 页面底端 -->
      <script>
        var bdmap=new BMap.Map('bdmap-contaniner');
        var point = new BMap.Point(117.147581,34.219845);
            bdmap.centerAndZoom(point, 15);
            bdmap.addControl(new BMap.NavigationControl());
            bdmap.enableScrollWheelZoom();

          // var div =  `<div>ff</div>`;
           
          //   var icon = new BMap.Icon('1.png', new BMap.Size(20, 32), {//是引用图标的名字以及大小，注意大小要一样
          //  anchor: new BMap.Size(10, 30)//这句表示图片相对于所加的点的位置
          //  });

            // var mkr = new BMap.Marker(new BMap.Point(116.38075,39.918986), {
            //     icon: div,
            //     title: "标记标题" 
            // }); 

        //       bdmap.addOverlay(mkr);    
        //       var centerMarker=new BMap.Marker(point);
        // centerMarker.addEventListener('click', function (eve) {
        //     var opts = {
        //         width : 250,     // 信息窗口宽度
        //         height: 100,     // 信息窗口高度
        //         title : "地点坐标"  // 信息窗口标题
        //     };
        //     var infoWindow_content='当前位置：('+eve.point.lng+','+eve.point.lat+')';
        //     var infoWindow = new BMap.InfoWindow(infoWindow_content, opts);  // 创建信息窗口对象
        //     bdmap.openInfoWindow(infoWindow, bdmap.getCenter());      // 打开信息窗口
        // });
        // bdmap.addOverlay(centerMarker);
                             // 将标注添加到地图中 
/********************************
* 
*数据获取
* 
********************************/
  function selectChange(that) {
          let region= document.getElementById("select_house_region").value;
              let sort = document.getElementById("select_house_sort").value;
              let type = document.getElementById("select_house_type").value;
              console.log(region,sort,type);
            
              console.log(that.value);
              //发送请求



              var xhr = new XMLHttpRequest();          

              xhr.open('GET',"http:localhost:3006/select/house?region="+region+"&housetype="+type+"", true);
              xhr.onreadystatechange = function() {
              // readyState == 4说明请求已完成
              if (xhr.readyState == 4 && xhr.status == 200 || xhr.status == 304) { 
                  // 从服务器获得数据 
                  console.log(xhr.responseText);  
                 
              }
              };
              xhr.send();
      }
</script>
      <script>
    
          document.getElementById("gisgroup_road_btn").onclick= function () {
            console.log("rout")
            var startPoint_input=document.getElementById("gisgroup_road_begin");
        var endPoint_input= document.getElementById("gisgroup_road_end");
        var routeType_select= document.getElementById("gisgroup_road_transform");
        var startPoint_value=startPoint_input.value;
        var endPoint_value=endPoint_input.value;
        var routeType_select_value=routeType_select.value;
        switch (routeType_select_value){
            case 'car':{
                //驾车路线规划
                var driving = new BMap.DrivingRoute(bdmap, {
                    renderOptions: {
                        map: bdmap,
                        autoViewport: true
                    }
                });
                //绘制
			
                driving.search(startPoint_value, endPoint_value);
            }
                break;
            case 'bus':{
			
                var transit = new BMap.TransitRoute(bdmap, {
                    renderOptions: {
                        map: bdmap,
                        autoViewport: true
                    }
                });
	
                transit.search(startPoint_value, endPoint_value);
            }break;
            case 'step':{
		
                var walk = new BMap.WalkingRoute(bdmap, {
                    renderOptions: {map: bdmap}
                });
			
                walk.search(startPoint_value, endPoint_value);
            }
                break;
        }
    }
      </script>
       <script type="text/javascript">
        // 百度地图API功能
    

        document.getElementById("gisgroup_recent_btn").onclick = function search(){
        console.log("efe f")
        var value =document.getElementById("gisgroup_recent_goal").value;
        var distance=document.getElementById("gisgroup_recent_distance").value;
        console.log(value);
        bdmap.clearOverlays();
        var circle = new BMap.Circle(new BMap.Point(117.22171, 34.22358),distance,{fillColor:"blue", strokeWeight: 1 ,fillOpacity: 0.3, strokeOpacity: 0.3});
        bdmap.addOverlay(circle);
        var local =  new BMap.LocalSearch(bdmap, {renderOptions: {map: bdmap, autoViewport: false}});  
        local.searchNearby(value,new BMap.Point(117.22171, 34.22358),distance);
        var local = new BMap.LocalSearch(bdmap, {renderOptions: {map: bdmap, panel: "gisgroup_recent_result"}});
      	local.searchNearby(value,new BMap.Point(117.22171, 34.22358),distance);
    }  </script>
    
    
        <script>
              var isvisible = false;
           function gisgrouprecentisvisual(){
            document.getElementById("mapsearch_gisgroup_recent").style.display="none";
            
            if(!isvisible)
            {
              document.getElementById("mapsearch_gisgroup_recent").style.display="block";
            isvisible = true;
            }else{
              document.getElementById("mapsearch_gisgroup_recent").style.display="none";
              isvisible= false; 
            }
           }
           function gisgrouproadisvisual(){
            document.getElementById("mapsearch_gisgroup_recent").style.display="none";
           
            if(!isvisible)
            {
              document.getElementById("mapsearch_gisgroup_road").style.display="block";
            isvisible = true;
            }else{
              document.getElementById("mapsearch_gisgroup_road").style.display="none";
              isvisible= false; 
            }
           }
        </script>

      
      <script>

      </script>
</body>
</html>






































































































































































































































































































































