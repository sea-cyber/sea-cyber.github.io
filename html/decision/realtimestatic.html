<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>实时监测统计</title>
    <link rel="stylesheet" href="../../theme/default/easyui.css" />
    <link rel="stylesheet" type="text/css" href="../../theme/icon.css" />
    <link rel="stylesheet" type="text/css" href="../../css/app.css" />
    <link rel="stylesheet" type="text/css" href="../../css/main.css" />
    <link rel="stylesheet" type="text/css" href="../../css/icon.css" />
    <link rel="stylesheet" type="text/css" href="../../css/dev.css" />
    <link type="text/css" href="../../css/dev.css" rel="stylesheet" />
    <script type="text/javascript" src="../../js/jquery.min.js"></script>
    <script type="text/javascript" src="../../js/jquery.easyui.min.js"></script>
    <script type="text/javascript" src="../../js/easyui-lang-zh_CN.js"></script>
    <script type="text/javascript" src="../../js/linq.min.js"></script>
    <script type="text/javascript" src="../../js/data.util.js"></script>
    <script type="text/javascript" src="../../js/jquery.dev.control.js"></script>
    <script type="text/javascript" src="../../js/linq.min.js"></script>
    <script type="text/javascript" src="../../js/dev.ui.js"></script>
    <script type="text/javascript" src="../../js/highcharts.js"></script>
    <script type="text/javascript" src="../../js/highcharts-more.js"></script>
    <script type="text/javascript" src="../../js/guid.js"></script>
    <style type="text/css">
        .staticcontent {
            width: 100%;
            height: 100%;
            position: relative;
        }

            .staticcontent .Header {
                height: 44px;
                border-bottom: 1px dashed #ddd;
                width: 100%;
                min-width: 1015px;
            }

                .staticcontent .Header .staticBtn {
                    width: 70px;
                    height: 26px;
                    margin-top: 2px;
                    background-color: #16dbbb;
                    margin-left: 4px;
                    line-height: 26px;
                    color: #fcfcfc;
                    text-align: center;
                    display: inline-block;
                    cursor: pointer;
                }

                    .staticcontent .Header .staticBtn:hover {
                        background-color: #5227de;
                        cursor: pointer;
                    }

                    .staticcontent .Header .staticBtn:active {
                        background-color: #210097;
                        cursor: pointer;
                    }

        .options {
            margin-left: 7px;
            margin-right: 3px;
        }
    </style>
    <script type="text/javascript">
        var Dev = window.top.window.dev;
        var parent, type, monitorseries, indepid, orgidcon;
        var box, statWin, exportform;
        var selectr = "全部", allid;
        var waitbox;
        function WidgetCommunication(s) {//部件通讯
            parent = s.parent;
            type = s.param.type;
            monitorseries = s.param.serialnumber;
            indepid = s.param.indepeid;
            orgidcon = s.param.orgid;
            $("#" + type).css("display", "block");
            box = new Dev.Box({ HasBorder: false, HorScroll: "auto", VerScroll: "auto" });
            box.Target.appendTo($("#content"));
            box.SetContent($("#" + type));
            $(window).resize(function () { resize(); });
            $("#begindate").datebox({ width: 150, height: 25 });
            $("#enddate").datebox({ width: 150, height: 25 });
            //初始化当前时间
            var timestr = Dev.GetNowDateString(true);
            $("#begindate").datebox("setValue", timestr);
            $("#enddate").datebox("setValue", timestr);
            $("#monitorlist").prop("$this").bind("onSelectChanged", function (s, e) {
                if (monitorseries == e.serialnumber) return;
                monitorseries = e.serialnumber;
            });
            getmonitorsbyindepid();
            initchart();
            waitbox = new Dev.UCWaitBox($(".staticcontent"));
            getdate();
            $(".staticBtn").click(function () {
                var tag = $(this).attr("tag");
                if (tag == "search") {
                    waitbox.Show();
                    getdate();
                }
                if (tag == "return") {
                    $("#errormsg").html("");
                    $("#monitorMap", Dev.App.FillPanel.Target).css("display", "block");
                    Dev.App.FillPanel.Remove("realtimestatic");
                }
                if (tag == "export") {
                    $("#Text1").datebox({ width: 170, height: 25 });
                    $("#Text2").datebox({ width: 170, height: 25 });
                    //初始化当前时间
                    //  var timest = Dev.GetNowDateString(true);
                    var time1 = $("#begindate").datebox("getValue");
                    var time2 = $("#enddate").datebox("getValue");
                    $("#Text1").datebox("setValue", time1);
                    $("#Text2").datebox("setValue", time2);
                    if (Dev.IsNull(statWin)) {
                        //initcomboTree();
                        getmonitorbyorg(orgidcon);
                        statWin = new Dev.Window({
                            ID: "exportWin",
                            IconCls: "icon-export-white",
                            Title: "导出",
                            Parent: $(".staticcontent").parent(),
                            Maximizable: false,
                            Modal: true,
                            Draggable: true,
                            HAlign: 'center',
                            VAlign: 'center',
                            Resizable: false,
                            Height: 300,
                            Width: 480,
                            Content: $("#export-div"),
                        });
                        $(".Header", statWin).css({ "min-width": "0", "height": "30px" });
                        $(".dev-radio", $("#export-div")).bind("onChange", function (s, e) {
                            selectr = e.Text;
                            if (selectr == "其它") {
                                statWin.SetHeight(290);
                                $("#qita").css("display", "block");
                            }
                            else {
                                statWin.SetHeight(260);
                                $("#qita").css("display", "none");
                            }
                        });
                    }
                    else
                        statWin.Open();
                }
            });
            $("#exportbt").click(function () {
                var indepdId, serialnumbers;
                //if (selectr == "全部") {
                //    indepdId = null;
                //    serialnumber = null;
                //}
                //else if (selectr == "当前一体机") {
                //    indepdId = indepid;
                //    serialnumber = null;
                //}
                //else {
                //    indepdId = allid;
                //    serialnumber = $("#comboxmot",statWin).prop("$this").GetValue();
                //}
                indepdId = allid;
                serialnumbers = $("#comboxmot", statWin).prop("$this").GetValue();
                $("#exportbt").attr("disabled", "disabled");
                var type = $("#typediv").prop("$this").GetValue();
                var checkV = "";    //监测类型
                $("input[name='mtype']:checked", $(".MachineEdit")).each(function (i) {//把所有被选中的复选框的值存入数组
                    checkV += $(this).val() + ",";
                });
                var fields = checkV.substring(0, checkV.length - 1);
                var datatype = $("#Div2").prop("$this").GetValue();
                var con = " 1=1 ";
                var time1 = $("#Text1").datebox("getValue");
                var time2 = $("#Text2").datebox("getValue");
                if (!Dev.IsNull(time1) && !Dev.IsNull(time2)) {
                    var t1 = new Date(time1.replace(/-/g, "/"));
                    var t2 = new Date(time2.replace(/-/g, "/"));
                    if (t1.getTime() > t2.getTime()) {
                        var temp = time1;
                        time1 = time2;
                        time2 = temp;
                    }
                    if (((t1.getTime() + (365 * 24 * 3600 * 1000)) < t2.getTime() || (t2.getTime() + (365 * 24 * 3600 * 1000)) < t1.getTime()) && datatype == "H") {
                        $("#tips").html("时间间隔大于一年，建议以月或天分组!");
                        return;
                    }
                    else
                        $("#tips").html("");
                }
                if (!Dev.IsNull(time1)) con += " AND \"UPLOADDATE\">='" + time1 + " 00:00:00'";
                if (!Dev.IsNull(time2)) con += " AND \"UPLOADDATE\"<='" + time2 + " 23:59:59'";
                if (Dev.IsNull(exportform)) {
                    exportform = $('<form id="expform" style="display: none;" method="post" enctype="application/x-www-form-urlencoded" target=""/>').appendTo(Dev.App.FillPanel.Target);
                    exportform.attr("action", Dev.GetSystemUrlByRelID("Service") + "meteorYtjData/exportTextOrExcel");
                    var input1 = $("<input></input>");
                    input1.attr("type", "hidden");
                    input1.attr({ "name": "type", "id": "ip1" });
                    input1.attr("value", type);
                    var input2 = $("<input></input>");
                    input2.attr("type", "hidden");
                    input2.attr({ "name": "fields", "id": "ip2" });
                    input2.attr("value", fields);
                    var input3 = $("<input></input>");
                    input3.attr("type", "hidden");
                    input3.attr({ "name": "serialnumbers", "id": "ip3" });
                    input3.attr("value", serialnumbers);
                    var input4 = $("<input></input>");
                    input4.attr("type", "hidden");
                    input4.attr({ "name": "datatype", "id": "ip4" });
                    input4.attr("value", datatype);
                    var input5 = $("<input></input>");
                    input5.attr("type", "hidden");
                    input5.attr({ "name": "indepdId", "id": "ip5" });
                    input5.attr("value", indepdId);
                    var input6 = $("<input></input>");
                    input6.attr("type", "hidden");
                    input6.attr({ "name": "where", "id": "ip6" });
                    input6.attr("value", con);
                    exportform.append(input1);
                    exportform.append(input2);
                    exportform.append(input3);
                    exportform.append(input4);
                    exportform.append(input5);
                    exportform.append(input6);
                }
                else {
                    $('#ip1', exportform).attr("value", type);
                    $('#ip2', exportform).attr("value", fields);
                    $('#ip3', exportform).attr("value", serialnumbers);
                    $('#ip4', exportform).attr("value", datatype);
                    $('#ip5', exportform).attr("value", indepdId);
                    $('#ip6', exportform).attr("value", con);
                }
                try {
                    exportform.submit();
                } catch (e) {

                }
                $("#exportbt").attr("disabled", true);
            });
            resize();
        }
        function getdate() {
            $("#errormsg").html("");
            if (Dev.IsNull(indepid) || Dev.IsNull(monitorseries)) return;
            var con = " 1=1 ";
            var time1 = $("#begindate").datebox("getValue");
            var time2 = $("#enddate").datebox("getValue");
            var t1, t2;
            if (!Dev.IsNull(time1)) t1 = new Date(time1.replace(/-/g, "/"));
            if (!Dev.IsNull(time2)) t2 = new Date(time2.replace(/-/g, "/"));
            if (t1.getTime() > new Date().getTime() || t2.getTime() > new Date().getTime()) { $("#errormsg").html("查看时间不能超过当前时间!"); waitbox.Close(); return; }
            if (!Dev.IsNull(time1) && !Dev.IsNull(time2)) {
                if (t1.getTime() > t2.getTime()) {
                    var temp = time1;
                    time1 = time2;
                    time2 = temp;
                }
                if ((t1.getTime() + (30 * 24 * 3600 * 1000)) < t2.getTime() || (t2.getTime() + (30 * 24 * 3600 * 1000)) < t1.getTime()) {
                    $("#errormsg").html("查看时间间隔不能大于一个月!");
                    waitbox.Close();
                    return;
                }
            }
            if (!Dev.IsNull(time1)) con += " AND \"UPLOADDATE\">='" + time1 + " 00:00:00'";
            if (!Dev.IsNull(time2)) con += " AND \"UPLOADDATE\"<='" + time2 + " 23:59:59'";
            $.ajax({
                url: Dev.GetSystemUrlByRelID("Service") + "meteorYtjData/queryDataByManyType",
                type: "POST",
                data: {
                    indepdId: indepid,
                    meteorSerNum: monitorseries,
                    dataType: getdatatypes().join(','),
                    where: con
                },
                success: function (result) {
                    waitbox.Close();
                    if (Dev.IsNull(result.data) || result.data.length == 0) {
                        for (var i = 0; i < chartcs.length; i++) {
                            chartcs[i].chartcontrol.series[0].data = [];
                            chartcs[i].chartcontrol.render();
                        }
                        return;
                    }
                    var resultdata = [];
                    for (var i = 0; i < result.data.length; i++) {
                        var xvalue = result.data[i].UPLOADDATE;
                        $.each(result.data[i], function (s, e) {
                            var currdata = Enumerable.From(resultdata).Where('s=>s.name=="' + s + '"').FirstOrDefault();
                            if (Dev.IsNull(currdata)) resultdata.push({ name: s, data: [[xvalue, e]] });
                            else currdata.data.push([xvalue, e]);
                        });
                    }
                    for (var i = 0; i < chartcs.length; i++) {
                        var needdata = Enumerable.From(resultdata).Where('s=>s.name=="' + chartcs[i].key + '"').FirstOrDefault();
                        if (Dev.IsNull(needdata)) chartcs[i].chartcontrol.series[0].setData([]);
                        else chartcs[i].chartcontrol.series[0].setData(needdata.data);
                    }
                },
                error: function (result) {
                    waitbox.Close();
                }
            });
        }
        var chartcs = [];
        function initchart() {
            for (var i = 0; i < $(".chartdiv", $("#" + type)).length; i++) {
                var key = $($(".chartdiv", $("#" + type))[i]).attr("name");
                var tag = $($(".chartdiv", $("#" + type))[i]).attr("tag")
                var currchart;
                $($(".chartdiv", $("#" + type))[i]).highcharts({
                    chart: { zoomType: 'x' },
                    credits: { enabled: false },
                    title: null,
                    lang: { noData: "没有数据" },
                    xAxis: {
                        labels: {
                            formatter: function () { var str = Dev.GetDateString(this.value); str = str.substr(5, 11); return str; }
                        }
                    },
                    tooltip: {
                        formatter: function (s) {
                            return Dev.GetDateString(this.x) + "<br/>" + this.series.name + ":" + this.y;
                        }
                    },
                    yAxis: {
                        title: { text: tag + '走势图' },
                        gridLineWidth: 0
                    },
                    legend: { enabled: false },
                    plotOptions: {
                        area: {
                            fillColor: {
                                linearGradient: { x1: 0, y1: 0, x2: 0, y2: 1 },
                                stops: [[0, Highcharts.getOptions().colors[0]], [1, Highcharts.Color(Highcharts.getOptions().colors[0]).setOpacity(0).get('rgba')]]
                            },
                            marker: { radius: 2 },
                            lineWidth: 1,
                            states: { hover: { lineWidth: 1 } },
                            threshold: null
                        }
                    },
                    series: [{
                        type: 'area',
                        name: tag,
                        data: []
                    }]
                }, function (c) { currchart = c });
                chartcs.push({ key: key, chartcontrol: currchart });
            }


        }//初始化统计图
        function resize() {
            var w = $(window).width();
            var h = $(window).height();
            if (!Dev.IsNull(box)) box.SetSize({ Width: w, Height: h - 45 });
        }//大小改变
        function getdatatypes() {
            var types = [];
            if (type == "temperature") types = ["FREEAIRTEMPERATURE", "FREEAIRHUMIDITY", "FREEAIRPRESSURE", "WINDSPEED", "WINDDIRECTION", "RAIN"];
            if (type == "soil") types = ["SOILTEMPERATURE1", "SOILHUMIDITY1", "SOILTEMPERATURE2", "SOILHUMIDITY2", "SOILTEMPERATURE3", "SOILHUMIDITY3", "PHVALUE"];
            if (type == "effecv") types = ["EFFECTIVERADIATION", "TOTALRADIATION"];
            if (type == "liquid") types = ["LIQUID"];
            return types;
        }//根据类型获取数据个数
        function getmonitorsbyindepid() {
            if (Dev.IsNull(indepid)) return;
            $.ajax({
                url: Dev.GetSystemUrlByRelID("Service") + "amstation/getbyfilter",
                type: "Post",
                contentType: 'application/json',
                dataType: 'json',
                data: "\"INDEPEID\"='" + indepid + "'",
                success: function (result) {
                    $("#monitorlist").prop("$this").SetData(result.data);
                    $("#monitorlist").prop("$this").SetValue(monitorseries);
                }
            });
        }
        function initcomboTree() {
            var treediv = $("#treeorg");
            orgcombotree = new Dev.Combotree({
                ValueField: "id", TextField: "name", ChildrenField: "child", PopupHeight: 300, Height: 24, Width: 240
            });
            treediv.append(orgcombotree.Target);
            orgcombotree.Layout();
            orgcombotree.bind("onSelectChanged", function (s, e) {
                if (Dev.IsNull(e)) return;
                var currvalue = e.$this.id;
                var orgids = [];
                orgids.push(currvalue);
                var isleaf = orgcombotree.tree.IsLeaf(e);
                if (!isleaf) {
                    var allchilds = orgcombotree.tree.GetAllChildren(e);
                    for (var i = 0; i < allchilds.length; i++) orgids.push(allchilds[i].id);
                }

                var con = "";
                if (Dev.IsNull(orgids) || orgids.length == 0) return;
                con = "\"ORGID\"  IN(";
                for (var i = 0; i < orgids.length; i++) con += "'" + orgids[i] + "',";
                con = con.substr(0, con.length - 1);
                con += ")";
                getmonitorbyorg(con);
            });
            //获取组织数据
            var orgid = Dev.cookie.user.orgid;
            $.ajax({
                url: Dev.GetSystemUrlByRelID("Service") + "organize/gettreebyid/" + orgid + "?" + new Date().getTime(),
                type: "Get",
                contentType: 'application/json',
                dataType: 'json',
                success: function (result) {
                    var treeData = Dev.ConvertTreeData(result.data, orgid);
                    orgcombotree.SetData(treeData);
                    if (treeData.length > 0) orgcombotree.SetValueEx(orgcombotree.tree.GetRoots()[0].id);
                }
            });
        }//初始化组织树
        function getmonitorbyorg(con) {
            $.ajax({
                url: Dev.GetSystemUrlByRelID("Service") + "amstation/getbyfilter",
                type: "Post",
                contentType: 'application/json',
                dataType: 'json',
                data: con,
                success: function (result) {
                    if (result.statusCode != 200 || result.data.length == 0) return;
                    selectbyindepid(result.data[0].indepeid);
                    allid = result.data[0].indepeid;
                }
            });

        }//获取组织下所有监测站点
        //根据一体机序列号查监测站
        function selectbyindepid(ipid) {
            if (Dev.IsNull(indepid)) return;
            $.ajax({
                url: Dev.GetSystemUrlByRelID("Service") + "amstation/getbyfilter",
                type: "Post",
                contentType: 'application/json',
                dataType: 'json',
                data: "\"INDEPEID\"='" + indepid + "'",
                success: function (result) {
                    var datadiv = result.data;
                    //datadiv.splice(0, 0, { no: "全部", serialnumber: null });
                    $("#comboxmot", statWin).prop("$this").SetData(datadiv);
                    $("#comboxmot", statWin).prop("$this").SetValue(monitorseries);
                }
            });
        }
    </script>
</head>
<body>
    <div class="staticcontent">
        <div class="Header">
            <div style="height: 30px; width: 250px; display: inline-block; float: left; margin-left: 20px; margin-top: 7px;">
                <div style="width: 60px; height: 30px; line-height: 30px; text-align: center; display: inline-block; float: left;">监测站</div>
                <div style="width: 184px; height: 30px; display: inline-block;">
                    <div class="dev-combobox" id="monitorlist" style="width: 184px; height: 24px; margin-top: 3px;" opt='{ "PopupHeight":"auto","TextField":"no","ValueField":"serialnumber","IsOverShow":true,"Padding":"0px 5px"}'></div>
                </div>
            </div>
            <div style="height: 30px; width: 400px; display: inline-block; float: left; margin-left: 20px; margin-top: 7px;">
                <div style="width: 60px; height: 30px; line-height: 30px; text-align: center; display: inline-block;">监测时间</div>
                <div style="width: 150px; height: 30px; display: inline-block;">
                    <input id="begindate" data-options="editable:false" />
                </div>
                <div style="height: 30px; line-height: 30px; display: inline-block;">至</div>
                <div style="width: 150px; height: 30px; display: inline-block;">
                    <input id="enddate" data-options="editable:false" />
                </div>
            </div>
            <div style="height: 30px; width: 250px; display: inline-block; margin-left: 20px; margin-top: 7px; float: left;">
                <div tag="search" class="staticBtn">查询</div>
                <div tag="export" class="staticBtn">导出</div>
                <div tag="return" class="staticBtn">返回</div>
            </div>
            <div id="errormsg" style="height: 30px; width: 300px; display: inline-block; margin-left: 40px; line-height: 30px; color: red; margin-top: 7px;"></div>
        </div>
        <div id="content" style="width: 100%; position: relative;">
            <div id="temperature" style="width: 100%; display: none; min-width: 1015px;">
                <div style="height: 267px; width: 100%; position: relative; margin-top: 10px;">
                    <div class="chartdiv" name="FREEAIRTEMPERATURE" tag="温度" style="height: 100%; width: calc(50% - 1px); display: inline-block; float: left;"></div>
                    <div class="chartdiv" name="FREEAIRHUMIDITY" tag="湿度" style="height: 100%; width: 50%; display: inline-block;"></div>
                </div>
                <div style="height: 267px; width: 100%; border-bottom: 1px dashed #ddd; position: relative; margin-top: 10px;">
                    <div class="chartdiv" name="FREEAIRPRESSURE" tag="大气压" style="height: 100%; width: calc(50% - 1px); display: inline-block; float: left;"></div>
                    <div class="chartdiv" name="RAIN" tag="雨量" style="height: 100%; width: 50%; display: inline-block;"></div>
                </div>
                <div style="height: 267px; width: 100%; position: relative; margin-top: 10px;">
                    <div class="chartdiv" name="WINDSPEED" tag="风速" style="height: 100%; width: calc(50% - 1px); display: inline-block; float: left;"></div>
                    <div class="chartdiv" name="WINDDIRECTION" tag="风向" style="height: 100%; width: 50%; display: inline-block;"></div>
                </div>
            </div>
            <div id="soil" style="width: 100%; min-width: 1015px; display: none;">
                <div style="height: 267px; width: 100%; border-bottom: 1px dashed #ddd; position: relative; margin-top: 10px;">
                    <div class="chartdiv" name="SOILTEMPERATURE1" tag="土壤温度1" style="height: 100%; width: calc(50% - 1px); border-right: 1px dashed #ddd; display: inline-block; float: left;"></div>
                    <div class="chartdiv" name="SOILHUMIDITY1" tag="土壤湿度1" style="height: 100%; width: 50%; display: inline-block;"></div>
                </div>
                <div style="height: 267px; width: 100%; border-bottom: 1px dashed #ddd; position: relative; margin-top: 10px;">
                    <div class="chartdiv" name="SOILTEMPERATURE2" tag="土壤温度2" style="height: 100%; width: calc(50% - 1px); border-right: 1px dashed #ddd; display: inline-block; float: left;"></div>
                    <div class="chartdiv" name="SOILHUMIDITY2" tag="土壤湿度2" style="height: 100%; width: 50%; display: inline-block;"></div>
                </div>
                <div style="height: 267px; width: 100%; border-bottom: 1px dashed #ddd; position: relative; margin-top: 10px;">
                    <div class="chartdiv" name="SOILTEMPERATURE3" tag="土壤温度3" style="height: 100%; width: calc(50% - 1px); border-right: 1px dashed #ddd; display: inline-block; float: left;"></div>
                    <div class="chartdiv" name="SOILHUMIDITY3" tag="土壤湿度3" style="height: 100%; width: 50%; display: inline-block;"></div>
                </div>
                <div style="height: 267px; width: 100%; border-bottom: 1px dashed #ddd; position: relative; margin-top: 10px;">
                    <div class="chartdiv" name="PHVALUE" tag="PH值" style="height: 100%; width: 100%;"></div>
                </div>
            </div>
            <div id="effecv" style="width: 100%; min-width: 1015px; display: none;">
                <div class="chartdiv" name="EFFECTIVERADIATION" tag="光合有效辐射" style="height: calc(50% - 10px); width: 100%; margin-top: 10px;"></div>
                <div class="chartdiv" name="TOTALRADIATION" tag="总辐射" style="height: calc(50% - 10px); width: 100%; margin-top: 10px;"></div>
            </div>
            <div id="liquid" style="width: 100%; height: 100%; display: none;">
                <div class="chartdiv" name="LIQUID" tag="液位" style="height: 100%; width: 100%;"></div>
            </div>
        </div>
    </div>
    <div id="export-div" class="MachineEdit" style="height: 224px; width: 480px">
        <div class="Row" style="display: none;">
            <div class="Cell" style="width: 120px;">
                <div style="width: 60px; height: 30px; margin-left: 10px; display: inline-block;">
                    <div id="radio1" class="dev-radio" style="width: 24px; height: 30px; line-height: 30px; margin-top: 5px;" opt='{ "Value":"全部","Text":"全部","Checked":true,"Name":"gp"}'></div>
                </div>
            </div>
            <div class="Cell" style="width: 140px;">
                <div style="width: 100px; height: 30px; display: inline-block;">
                    <div id="radio2" class="dev-radio" style="width: 24px; height: 30px; line-height: 30px; margin-top: 5px;" opt='{ "Value":"当前一体机","Text":"当前一体机","Name":"gp"}'></div>
                </div>
            </div>
            <div class="Cell" style="width: 120px;">
                <div style="width: 60px; height: 30px; display: inline-block;">
                    <div id="radio3" class="dev-radio" style="width: 24px; height: 30px; line-height: 30px; margin-top: 5px;" opt='{ "Value":"其它","Text":"其它","Name":"gp"}'></div>
                </div>
            </div>
        </div>
        <div id="qita" class="Row" style="display: block">
            <!--<div class="Cell" style="width: 250px;">
                <div id="treeorg" style="height: 24px; margin-top: 5px; margin-left: 15px">
                </div>
            </div>-->
            <div class="Cell" style="width: 450px;">
                <div style="width: 80px; line-height: 35px; text-align: center; display: inline-block; float: left;">监&ensp;测&ensp;站</div>
                <div style="width: 365px; height: 30px; display: inline-block;">
                    <div class="dev-combobox" id="comboxmot" style="width: 365px; height: 24px; margin-top: 5px; margin-left: 6px;" opt='{ "MultiSelect":true,"PopupHeight":"auto","TextField":"no","ValueField":"serialnumber","IsOverShow":true,"Padding":"0px 5px"}'></div>
                </div>
            </div>
        </div>
        <div class="Row">
            <div class="Cell" style="width: 580px;">
                <div style="width: 80px; height: 30px; line-height: 35px; text-align: center; display: inline-block;">监测时间</div>
                <div style="width: 170px; height: 30px; display: inline-block;">
                    <input id="Text1" data-options="editable:false" />
                </div>
                <div style="height: 40px; line-height: 35px; display: inline-block;">至</div>
                <div style="width: 170px; height: 30px; display: inline-block;">
                    <input id="Text2" data-options="editable:false" />
                </div>
            </div>
        </div>
        <div class="Row">
            <div class="Cell" style="width: 225px;">
                <div style="width: 80px; line-height: 35px; text-align: center; display: inline-block; float: left;">导出类型</div>
                <div style="width: 145px; height: 30px; display: inline-block;">
                    <div class="dev-combobox" id="typediv" style="z-index: 3; width: 145px; margin-top: 5px; margin-left: 6px;" opt='{"TextField":"Text","ValueField":"Type","Height":26,"Data":[{"Text":"文本文件","Type":"0"},{"Text":"Excel","Type":"1"}],"SelectedIndex":0,"IsOverShow":true,"Padding":"0px 5px","TextAlign":"left"}'></div>
                </div>
            </div>
            <div class="Cell" style="width: 225px;">
                <div style="width: 80px; line-height: 35px; text-align: center; display: inline-block; float: left;">分组类型</div>
                <div style="width: 145px; height: 30px; display: inline-block;">
                    <div class="dev-combobox" id="Div2" style="z-index: 3; width: 145px; margin-top: 5px;" opt='{"TextField":"Text","ValueField":"Type","Height":26,"Data":[{"Text":"月","Type":"M"},{"Text":"天","Type":"D"},{"Text":"小时","Type":"H"}],"SelectedIndex":1,"IsOverShow":true,"Padding":"0px 5px","TextAlign":"left"}'></div>
                </div>
            </div>
        </div>
        <div class="Row" style="height: 105px;">
            <div class="Title1" style="float: left; display: inline-block; margin-top: 19px; margin-left: 15px;">导出数据</div>
            <div style="width: 400px; height: 24px; margin-top: 6px; margin-left: 70px">
                <input type="checkbox" class="options" name="mtype" checked="checked" value="FREEAIRTEMPERATURE" />大气温度
                <input type="checkbox" class="options" name="mtype" value="FREEAIRHUMIDITY" />大气湿度
		        <input type="checkbox" class="options" name="mtype" value="FREEAIRPRESSURE" />大气压力
		        <input type="checkbox" class="options" name="mtype" value="EFFECTIVERADIATION" />光照强度
		        <input type="checkbox" class="options" name="mtype" value="TOTALRADIATION" />总辐射
            </div>
            <div style="width: 400px; height: 24px; margin-top: 4px; margin-left: 70px">
                <input type="checkbox" class="options" name="mtype" value="WINDSPEED" />风速
		        <input type="checkbox" class="options" name="mtype" value="WINDDIRECTION" />风向
                <input type="checkbox" class="options" name="mtype" value="RAIN" />雨量
		        <input type="checkbox" class="options" name="mtype" value="SOILTEMPERATURE1" />土壤10cm温度
		        <input type="checkbox" class="options" name="mtype" value="SOILHUMIDITY1" />土壤10cm湿度
            </div>
            <div style="width: 400px; height: 24px; margin-top: 4px; margin-left: 70px">
                <input type="checkbox" class="options" name="mtype" value="SOILTEMPERATURE2" />土壤20cm温度
		        <input type="checkbox" class="options" name="mtype" value="SOILHUMIDITY2" />土壤20cm湿度
                <input type="checkbox" class="options" name="mtype" value="SOILTEMPERATURE3" />土壤30cm温度
		        <input type="checkbox" class="options" name="mtype" value="SOILHUMIDITY3" />土壤30cm湿度
            </div>
            <div style="width: 400px; height: 24px; margin-top: 4px; margin-left: 70px">
                <input type="checkbox" class="options" name="mtype" value="LIGHTING" />其他
            </div>
        </div>
        <div id="tips" style="height: 30px; width: 300px; display: inline-block; margin-left: 5px; line-height: 30px; color: red; margin-top: 10px;"></div>
        <div class="Submit" style="margin-right: 10px;">
            <div id="exportbt" class="Button" tag="exportdata" style="margin-top: 7%">
                <span style="line-height: 26px; color: #fcfcfc;">导&nbsp;&nbsp;出</span>
            </div>
        </div>
    </div>
</body>
</html>
