<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>农机作业编辑</title>
    <link rel="stylesheet" href="../../theme/default/easyui.css" />
    <link rel="stylesheet" type="text/css" href="../../theme/icon.css" />
    <link rel="stylesheet" type="text/css" href="../../css/app.css" />
    <link rel="stylesheet" type="text/css" href="../../css/main.css" />
    <link rel="stylesheet" type="text/css" href="../../css/icon.css" />
    <link type="text/css" href="../../css/dev.css" rel="stylesheet" />
    <script type="text/javascript" src="../../js/jquery.min.js"></script>
    <script type="text/javascript" src="../../js/jquery.easyui.min.js"></script>
    <script type="text/javascript" src="../../js/easyui-lang-zh_CN.js"></script>
    <script type="text/javascript" src="../../js/linq.min.js"></script>
    <script type="text/javascript" src="../../js/data.util.js"></script>
    <script type="text/javascript" src="../../js/dev.ui.js"></script>
    <style type="text/css">
        .content {
            width: 100%;
            height: 100%;
        }

            .content .logo {
                height: 26px;
                width: 26px;
                display: inline-block;
                float: left;
                margin-top: 20px;
                margin-left: 30px;
            }

            .content .logoText {
                height: 26px;
                display: inline-block;
                margin-left: 6px;
                line-height: 28px;
                color: #cacaca;
                font-weight: bold;
                font-size: 16px;
                margin-top: 20px;
            }

            .content .logoText_select {
                color: #4855EE;
            }

            .content .row {
                height: 30px;
                width: calc(100% - 12px);
                position: relative;
                margin-top: 6px;
            }

                .content .row:nth-child(1) {
                    margin-top: 10px;
                }

                .content .row .cell {
                    width: 50%;
                    height: 100%;
                    position: relative;
                    display: inline-block;
                    float: left;
                }

                .content .row .title {
                    text-align: right;
                    padding-right: 8px;
                    width: 67px;
                    display: inline-block;
                    height: 35px;
                    line-height: 35px;
                    float: left;
                }

                .content .row .value {
                    width: 171px;
                    height: 35px;
                    padding-left: 5px;
                    display: inline-block;
                    line-height: 35px;
                    overflow-x: hidden;
                    overflow-y: auto;
                    color: gray;
                }

                .content .row .part {
                    width: calc(100% - 80px);
                    height: 65px;
                    line-height: 20px;
                }
    </style>
    <script type="text/javascript">
        var Dev = window.top.window.dev;
        var parent, id;
        function WidgetCommunication(s) {//部件通讯
            parent = s.parent;
            id = s.param.id;
            getData();
        }


        //获取当前数据
        function getData() {
            $.ajax({
                type: "get",
                url: Dev.cookie.baseUri + "task/getbyfilter/\"ID\"=\'" + id + "\'",
                success: function (response) {
                    loadData(response.data[0]);
                }
            });
        }
        //通过当前组织机构id查询机构名称
        function getOrgnamebyid(orgid) {
            var orgname;
            $.ajax({
                type: "get",
                async: false,
                url: Dev.cookie.baseUri + "organize/getOrganizeNameById/" + orgid,
                success: function (response) {
                    orgname = response.data;
                }
            });
            return orgname;
        }
        //根据接受人的id查询接受人名称
        function getUsernamebyid(userid) {
            var username;
            $.ajax({
                type: "get",
                async: false,
                url: Dev.cookie.baseUri + "user/getbyfilter/\"ID\"=\'" + userid + "\'",
                success: function (response) {
                    username = response.data[0].name;
                }
            });
            return username;
        }

        function loadData(data) {
            if (Dev.IsNull(data)) return;
            $.each(data, function (e, o) {
                var curr = $('div[name="' + e + '"]');
                if (!Dev.IsNull(curr) && curr.length > 0) {
                    //if (e == "cultivated") o = o + "(亩)";
                    if (e == "orgid") o = getOrgnamebyid(o);
                    if (e == "starttime") o = Dev.GetDateString(o);
                    if (e == "endtime") o = Dev.GetDateString(o);
                    if (e == "userid") o = getUsernamebyid(o);
                    curr.html(o);
                }
            });
            //显示行政区
            var xzq = "";
            if (!Dev.IsNullAll(data.province)) xzq += data.province + " ";
            if (!Dev.IsNullAll(data.city)) xzq += data.city + " ";
            if (!Dev.IsNullAll(data.county)) xzq += data.county + " ";
            if (!Dev.IsNullAll(data.town)) xzq += data.town + " ";
            if (!Dev.IsNullAll(data.village)) xzq += data.village + " ";
            $("div[name='xzqtext'").html(xzq);
        }

    </script>
</head>
<body>
    <div class="content">
        <div class="basictask_info">
            <div class="logo" style="background-image: url(../../image/agri/taskfirst1.png)"></div>
            <div class="logoText logoText_select">任务基本信息</div>
            <div class="task">
                <div class="row">
                    <div class="cell" style="width: 100%;">
                        <div class="title">任务名称</div>
                        <div name="name" class="value"></div>
                    </div>
                </div>

                <div class="row">
                    <div class="cell" style="width:100%;">
                        <div class="title">组织机构</div>
                        <div name="orgid" class="value" style=" width: calc(100% - 80px);"></div>
                    </div>
                </div>
                <div class="row">
                    <div class="cell">
                        <div class="title">接受人&nbsp;</div>
                        <div name="userid" class="value"></div>
                    </div>
                     <div class="cell">
                        <div class="title">任务状态</div>
                        <div name="state" class="value"></div>
                    </div>
                </div>

                <div class="row">
                    <div class="cell">
                        <div class="title">任务类型</div>
                        <div name="type" class="value"></div>
                    </div>
                    <div class="cell">
                        <div class="title">任务类别</div>
                        <div name="category" class="value"></div>
                    </div>
                </div>

                <div class="row" style="height:65px;">
                    <div class="cell" style="width: 100%;">
                        <div class="title" style="line-height:20px;">任务内容</div>
                        <div name="content" class="value part"></div>
                    </div>
                </div>

                <div class="row">
                    <div class="cell">
                        <div class="title">开始时间</div>
                        <div name="starttime" class="value"></div>
                    </div>
                    <div class="cell">
                        <div class="title">结束时间</div>
                        <div name="endtime" class="value"></div>
                    </div>
                </div>

            </div>
        </div>
        <div class="operation_route">
            <div class="logo" style="background-image: url(../../image/agri/tasksecond1.png)"></div>
            <div class="logoText logoText_select">规划农机作业路线</div>
            <div class="route">
                <div class="row">
                    <div class="cell" style="width: 100%;">
                        <div class="title">作业地区</div>
                        <div name="xzqtext" class="value" style=" width: calc(100% - 80px);"></div>
                    </div>
                </div>
                 <div class="row">
                    <div class="cell">
                        <div class="title">农机&nbsp;&nbsp;</div>
                        <div name="no" class="value"></div>
                    </div>
                    <div class="cell">
                        <div class="title">农具名称</div>
                        <div name="farmname" class="value"></div>
                    </div>
                </div>
                 <div class="row">
                    <div class="cell">
                        <div class="title">作业方式</div>
                        <div name="derection" class="value"></div>
                    </div>
                    <div class="cell">
                        <div class="title">作业模式</div>
                        <div name="startendpoint" class="value"></div>
                    </div>
                </div>
            </div>
        </div>

    </div>
</body>
</html>
