<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>无人机作业编辑</title>
    <link rel="stylesheet" href="../../theme/default/easyui.css" />
    <link rel="stylesheet" type="text/css" href="../../theme/icon.css" />
    <link rel="stylesheet" type="text/css" href="../../css/app.css" />
    <link rel="stylesheet" type="text/css" href="../../css/main.css" />
    <link rel="stylesheet" type="text/css" href="../../css/icon.css" />
    <link type="text/css" href="../../css/dev.css" rel="stylesheet" />
    <script type="text/javascript" src="../../js/jquery.min.js"></script>
    <script type="text/javascript" src="../../js/jquery.easyui.min.js"></script>
    <script type="text/javascript" src="../../js/easyui-lang-zh_CN.js"></script>
    <script type="text/javascript" src="../../js/linq.min.js"></script>
    <script type="text/javascript" src="../../js/data.util.js"></script>
    <script type="text/javascript" src="../../js/dev.ui.js"></script>
    <script type="text/javascript" src="../../js/guid.js"></script>
    <script type="text/javascript" src="../../js/jquery.dev.control.js"></script>
    <script type="text/javascript" src="../../js/dev.uavline.js"></script>
    <script type="text/javascript">
        var Dev = window.top.window.dev;
        var parent, orglist, row;
        var orgControl;
        var flashDialog;
        var uavPageIndex = 1, uavPageSize = 5;
        var curOrgid;
        var draw1;
        var updateId;
        var isallow = true;//防止重复请求
        var geomParams;
        var fishnetf, routefeature;
        function WidgetCommunication(s) {//部件通讯
            parent = s.parent;
            orglist = s.param.orglist;
            row = s.param.row;
            if (!Dev.IsNull(row)) { updateId = row.id; }
            initTime();
            initReceiveder();
            initUav();
            //  inituavline();
            initOrg();//放在最后执行，tree的选择事件来触发‘无人机’、‘接收人’的查询请求。
            flashDialog = new Dev.Messager({ Height: 95, Width: 200, AutoShow: false, Type: "question", Timeout: 1500, ButtonVisible: false, AutoVisible: true, Effect: "normal" });
            $(".Button").click(function () {
                var tag = $(this).attr("tag");
                if (tag == "save") { saveInfo(); }
                if (tag == "cancel") { parent.Close(); }
            });
            $(".drawbutton").click(function () {

                var tag = $(this).attr("tag");
                if (tag == "drawfishnet") {
                    Dev.MapUtils.ClearFeature("tempGraphicLayer");
                    Dev.MapUtils.ClearFeature("tempDrawLayer");
                    //移除feautef
                    var c_f = Dev.MapUtils.GetFeatureByID("fishnetf", "tempGraphicLayer", Dev.App.Map);
                    if (!Dev.IsNull(c_f)) Dev.MapUtils.RemoveFeature(c_f, "tempGraphicLayer", Dev.App.Map);
                    if (!Dev.IsNull(draw1)) { draw1.Target.unbind("onDrawCompleted"); draw1.Stop(); draw1.Destroy(); }
                    draw1 = new Dev.Draw({ Type: "Polygon", Map: Dev.App.Map, Layer: Dev.MapUtils.GetLayer("tempDrawLayer", Dev.App.Map) });
                    draw1.Target.bind("onDrawCompleted", function (s, e) {
                        Dev.App.MapPanel.MapDOM.css("cursor", "url(" + Dev.App.Root + "image/hands.cur),auto");
                        Dev.drawstate = false;
                        fishnetf = e;
                        var new_geom = e.getGeometry().clone();
                        var mapproj = Dev.App.Map.getView().getProjection();
                        if (mapproj.getCode() != Dev.App.Config.SystemMap.DataEPSG) new_geom.transform(mapproj.getCode(), Dev.App.Config.SystemMap.DataEPSG);
                        var geomstr = new_geom.getCoordinates();
                        geomstr = geomstr.join(",").replace(/,/g, " ");
                        var control = $('.dev-text[name="fishnet"]');
                        if (!Dev.IsNull(control)) control.prop("$this").SetValue(geomstr);
                        draw1.Stop();
                        draw1.Destroy();
                    });
                    draw1.Start();
                    Dev.App.MapPanel.MapDOM.css("cursor", "url(" + Dev.App.Root + "image/cursor_draw.cur),auto");
                    Dev.drawstate = true;
                }
                if (tag == "drawflyroute") {
                    Dev.MapUtils.ClearFeature("tempGraphicLayer");
                    if ($(this).hasClass("disablebutton")) return;

                    createline();
                    Dev.App.EventObject.unbind("onUAVLineChange");
                    Dev.App.EventObject.bind("onUAVLineChange", function (s, e) {
                        if (Dev.IsNull(e.linepoings)) return;
                        var line_points = e.linepoings;
                        var mapproj = Dev.App.Map.getView().getProjection();
                        if (mapproj.getCode() != Dev.App.Config.SystemMap.DataEPSG) {
                            var c_geom = new Dev.geom.LineString(e.linepoings);
                            c_geom.transform(mapproj.getCode(), Dev.App.Config.SystemMap.DataEPSG);
                            line_points = c_geom.getCoordinates();
                        }
                        var pointsstr = line_points.join(",").replace(/,/g, ' ');
                        $(".dev-textbox[name='route']").prop("$this").SetValue(pointsstr);
                    });
                }
            });
            //旁向重叠率改变事件
            var siderate_control = $("#editDiv [name='siderate']").prop("$this");
            siderate_control.bind("onChange", function (s, e) {
                if (Dev.IsNull(e.newValue)) { $(".drawbutton[tag='drawflyroute']").addClass("disablebutton"); return; }
                if (parseInt(e.newValue) <= 0) { $(".drawbutton[tag='drawflyroute']").addClass("disablebutton"); return; }
                $(".drawbutton[tag='drawflyroute']").removeClass("disablebutton");
                mSideRate = parseInt(e.newValue);
            });
            if (!Dev.IsNull(updateId)) { loadData(); }
            parent.clear = function () {
                if (!Dev.IsNull(draw1)) { draw1.Target.unbind("onDrawCompleted"); draw1.Stop(); draw1.Destroy(); }
                Dev.App.EventObject.unbind("onUAVLineChange");
                uavlineclear();
                Dev.MapUtils.ClearFeature("tempDrawLayer");
                Dev.MapUtils.ClearFeature("tempGraphicLayer");
            };
        }
        //判断路线是否在电子围栏内
        function iscontain() {
            if (Dev.IsNull(fishnetf) || Dev.IsNull(routefeature)) return;
            var wkt = Dev.GetWKTByFeature(fishnetf, false);
            var wkt1 = Dev.GetWKTByFeature(routefeature, false);
            var iscontcontrol = new Dev.WPS_Contains({
                Url: Dev.GetSystemUrlByRelID("GeoServiceOWS"),
                Features: [fishnetf, routefeature],
                Async: false,
            });
            return iscontcontrol.IsContains();
        }
        function initOrg() {
            orgControl = new Dev.Combotree({
                Required: true,
                PopupHeight: 120,
                TipInfo: "选择组织",
                MultiSelect: false,
                ValueField: "id",
                TextField: "name",
                ChildrenField: "child",
                Height: 27,
                Width: 269
            });
            $("#orgcombotree").append(orgControl.Target);
            orgControl.Layout();
            //组织变更的时，切换任务接收人
            orgControl.bind("onSelectChanged", function (n, e) {
                $("#receiveder").combogrid("setValue", "");
                $("#receiveder").combogrid("grid").datagrid('loadData', { total: 0, rows: [] });
                $("#uavno").combogrid("setValue", "");
                curOrgid = e.id;
                var orgidArr = [];
                orgControl.GetValue("");
                orgidArr.push(e.id);
                var isleaf = orgControl.tree.IsLeaf(e);
                if (!isleaf) {
                    var allchilds = orgControl.tree.GetAllChildren(e);
                    for (var i = 0; i < allchilds.length; i++) orgidArr.push(allchilds[i].id);
                }
                
                findUserbyorgids(orgidArr);//查询当前组织节点的用户
                uavPageIndex = 1;
                finduvaByPage();
            });
            //绑定父页面传递过来的组织节点
            orgControl.SetData(orglist);
        }
        function initTime() {
            $("#starttime").datetimebox({ onChange: function () { $("#endtime").datetimebox("validate");}});
            $("#endtime").datetimebox({ onChange: function () { $("#starttime").datetimebox("validate");}});
            $.extend($.fn.validatebox.defaults.rules, {
                timeCheck: {
                    validator: function (value, params) {
                        var another = $(params[0]).datetimebox("getValue");
                        if (Dev.IsNull(another)|| Dev.IsNull(value)) { return true; }
                        var bgStr = $("#starttime").datetimebox("getValue");
                        var cpStr = $("#endtime").datetimebox("getValue");
                        var starttime = new Date(bgStr.replace(/-/g, "/")).getTime();
                        var endtime = new Date(cpStr.replace(/-/g, "/")).getTime();
                        return starttime <= endtime;
                    },
                    message: '开始时间必须小于结束时间'
                }
            });
        }
        function initReceiveder() {
            $("#receiveder").combogrid({
                idField: 'id',
                textField: 'truename',
                columns: [[
                    { field: 'id', title: '主键', align: 'center', width: 60, hidden: true },
                    { field: 'no', title: '编号', align: 'center', width: 60 },
                    { field: 'truename', title: '真实姓名', align: 'center', width: 78 },
                    { field: 'name', title: '登录名', align: 'center', width: 70 },
                    { field: 'cano', title: 'CA证书', align: 'center', width: 60 }
                ]],
                width: 270,
                height: 25,
                panelWidth: 270,
                panelHeight: 160
            });
        }
        function findUserbyorgids(orgidArr) {
            $.ajax({
                url: Dev.GetSystemUrlByRelID("Service") + "user/finduserbyorgids",
                type: "POST",
                contentType: 'application/json',
                dataType: 'json',
                async: false,
                data: JSON.stringify(orgidArr),
                success: function (result) {
                    if (result.statusCode != 200) return;
                    $("#receiveder").combogrid("setValue", "");
                    $("#receiveder").combogrid("grid").datagrid("loadData", result.data);
                }
            });
        }
        function initUav() {
            $("#uavno").combogrid({
                idField: 'no',
                textField: 'no',
                columns: [[
                    { field: 'id', title: '主键', align: 'center', width: 60, hidden: true },
                    { field: 'no', title: '无人机编号', align: 'center', width: 75 },
                    { field: 'type', title: '无人机类型', align: 'center', width: 93 },
                    { field: 'brand', title: '无人机品牌', align: 'center', width: 90 },
                    { field: 'spec', title: '无人机型号', align: 'center', width: 90 }
                ]],
                width: 270,
                height: 25,
                panelWidth: 350,
                panelHeight: 183,
                pagination: true,
                // toolbar: $("#toobarRec"),
            });
            var uavnoPage = $("#uavno").combogrid("grid").datagrid("getPager");
            var parampage = {
                showPageList: false,
                showRefresh: false,
                pageNumber: uavPageIndex,
                pageSize: uavPageSize,
                onSelectPage: function (index, size) {
                    uavPageIndex = index;//A翻页页码加一
                    finduvaByPage();
                }
            };
            uavnoPage.pagination(parampage);
        }
        function finduvaByPage() {
            var con = " 1=1 AND \"DEVICETYPE\"='无人机' ";
            var url = Dev.GetSystemUrlByRelID("Service") + "device/findbyfilterpage/" + uavPageIndex + "/" + uavPageSize + "/" + curOrgid;
            $.ajax({
                url: url,
                type: "POST",
                contentType: 'application/json',
                dataType: 'json',
                data: con,
                success: function (result) {
                    if (result.statusCode != 200 || Dev.IsNull(result.data)) return;
                    $("#uavno").combogrid("grid").datagrid("loadData", []);
                    $("#uavno").combogrid("grid").datagrid("loadData", result.data.dataSource);
                    $("#uavno").combogrid("grid").datagrid("getPager").pagination('refresh', { total: result.data.pageInfo.totalCount, pageNumber: result.data.pageInfo.pageIndex });
                }
            });
        }

        function loadData() {
            $("#editDiv .save").each(function (index, element) {
                var name = $(this).attr("name");
                if ($(this).attr("class").indexOf("combogrid") > -1) {
                    name = $(this).attr("textboxname");
                    $(this).combogrid("setValue", row[name]);
                }
                else if ($(this).hasClass("easyui-datetimebox")) {
                    name = $(this).attr("textboxname");
                    $(this).datetimebox("setValue", Dev.GetDateString(row[name]));
                }
                else if ($(this).attr("name") == "orgid") {
                    $($(this).children()[0]).prop("$this").SetValueEx(row[name]);
                }
                else {
                    $(element).prop("$this").SetValue(row[name]);
                    if (name == "content") {
                        $(element).prop("$this").SetLengthTip(row[name]);//加载时显示字数
                    }
                }
            });
            loadTemp()
        }
        function loadTemp() {
            var siderate = $("#editDiv [name='siderate']").prop("$this").GetValue();
            $(".drawbutton[tag='drawflyroute']").removeClass("disablebutton");
            mSideRate = parseInt(siderate);
            //显示电子围栏
            var fishnetstr = $("#editDiv [name='fishnet']").prop("$this").GetValue();
            var fishnetpoints = [];
            var fishnets = fishnetstr.split(' ');
            for (var i = 0; i < fishnets.length; i += 2) fishnetpoints.push([parseFloat(fishnets[i]), parseFloat(fishnets[i + 1])]);
            var fishnetpolygon = new Dev.Feature(new Dev.geom.Polygon([fishnetpoints]));
            fishnetpolygon.setId("fishnetf");
            fishnetpolygon.setStyle(new Dev.style.Style({
                fill: new Dev.style.Fill({ color: "rgba(255,0,0,0.2)" }),
                stroke: new Dev.style.Stroke({ color: "rgba(255,0,0,1)", width: 1 })
            }));
            fishnetf = fishnetpolygon;
            Dev.MapUtils.AddFeature(fishnetpolygon, "tempGraphicLayer", Dev.App.Map);
            //添加图形
            var routeStr = $("#editDiv [name='route']").prop("$this").GetValue();
            var linepoints = [];
            var routes = routeStr.split(' ');
            for (var i = 0; i < routes.length; i += 2) linepoints.push([parseFloat(routes[i]), parseFloat(routes[i + 1])]);
            var f = new Dev.Feature(new Dev.geom.LineString(linepoints));
            f.setId("lineroutef");
            routefeature = f;
            Dev.MapUtils.AddFeature(f, "tempGraphicLayer", Dev.App.Map);
        }
        function saveInfo() {
            if (!isallow) { return; }
            var model = {};
            var $emsg = $("#emsg");
            var isok = true;
            $("#editDiv .save").each(function (index, element) {
                var displayName = element.dataset.name;
                var wordMax = element.dataset.wordmax;
                var value = "";
                var name = $(this).attr("name");
                if ($(this).attr("class").indexOf("combogrid") > -1) {
                    var selectrow = $(this).combogrid("grid").datagrid("getSelected");
                    name = $(this).attr("textboxname");
                    if (!Dev.IsNull(selectrow) && name == "userid") value = selectrow.id;
                    if (!Dev.IsNull(selectrow) && name == "no") value = selectrow.no;
                }
                else if ($(this).hasClass("easyui-datetimebox")) {
                    name = $(this).attr("textboxname");
                    value = $(this).datetimebox("getValue");
                    if (!Dev.IsNull(value)) {
                        value = new Date(value.replace(/-/g, "/")).getTime() + 3600000;
                        if (value < new Date().getTime()) {
                            $emsg.html((name == "starttime" ? "计划开始时间" : "计划结束时间") + '不能小于当前时间!');
                            isok = false;
                            return false;
                        }
                    }
                }
                else if ($(this).attr("name") == "orgid") value = $($(this).children()[0]).prop("$this").GetValue();
                else {
                    value = $(element).prop("$this").GetValue();
                    if (!Dev.IsNull(value)) { value = value.trim(); }
                }
                if (Dev.IsNull(value)) {
                    $emsg.html(displayName + '不能为空!');
                    isok = false;
                    return false;
                }
                if (!Dev.IsNull(wordMax) && value.length > parseInt(wordMax)) {
                    $emsg.html(displayName + '不能超过' + wordMax + '个字');
                    isok = false;
                    return false;
                }
                model[name] = value;
            });
            if (!isok) { return; }
            var isgeomcontain = iscontain();
            if (!isgeomcontain) { $emsg.html("飞行路线不在电子围栏中！"); return; }
            model.state = "待接收";
            var url;
            if (!Dev.IsNull(updateId)) {
                model.id = updateId;
                url = Dev.GetSystemUrlByRelID("Service") + "uav/updateUavTask";
            }
            else { url = Dev.GetSystemUrlByRelID("Service") + "uav/insert"; }
            isallow = false;
            model.devicetype = "无人机";
            $.ajax({
                url: url,
                type: "POST",
                contentType: 'application/json',
                dataType: 'json',
                data: JSON.stringify(model),
                success: function (result) {
                    if (result.statusCode != 200) return;
                    flashDialog.Alert("保存成功", "success");
                    parent.Close();
                },
                error: function (msg) {
                    flashDialog.Alert("保存失败", "error");
                },
                complete:function () {
                    isallow = true;
                }

            });
        }
        (function ($) {
            var dragcoordinate_, dragfeature_, dragcursor_ = 'pointer', previousCursor_ = undefined;
            var dragcoordinates_, dragfeatures_ = [];
            Dev.DragFeatures = function (opt) {
                Dev.interaction.Pointer.call(this, {
                    handleDownEvent: Dev.DragFeatures.prototype.handleDownEvent,
                    handleDragEvent: Dev.DragFeatures.prototype.handleDragEvent,
                    handleMoveEvent: Dev.DragFeatures.prototype.handleMoveEvent,
                    handleUpEvent: Dev.DragFeatures.prototype.handleUpEvent
                });
            }
            Dev.inherits(Dev.DragFeatures, Dev.interaction.Pointer);
            Dev.DragFeatures.prototype.handleDownEvent = function (evt) {
                var feature = Dev.App.Map.forEachFeatureAtPixel(evt.pixel, function (feature) {
                    if (feature.getId() == "rectf") return feature;
                });
                if (feature) {
                    dragcoordinate_ = evt.coordinate;
                    dragfeature_ = feature;
                }
                return !!feature;
            };
            Dev.DragFeatures.prototype.handleDragEvent = function (evt) {
                var feature = Dev.App.Map.forEachFeatureAtPixel(evt.pixel, function (feature) {
                    if (feature.getId() == "rectf") return feature;
                });
                var deltaX = evt.coordinate[0] - dragcoordinate_[0];
                var deltaY = evt.coordinate[1] - dragcoordinate_[1];
                var geometry = (dragfeature_.getGeometry());
                geometry.translate(deltaX, deltaY);
                dragcoordinate_ = evt.coordinate;
                //获取对应的feature
                var linef = Dev.MapUtils.GetFeatureByID("lineroutef", "tempGraphicLayer", Dev.App.Map);
                if (!Dev.IsNull(linef)) {
                    var cgeom = linef.getGeometry();
                    cgeom.translate(deltaX, deltaY);
                }
                var v_f = Dev.MapUtils.GetFeatureByID("vMarkerf", "tempGraphicLayer", Dev.App.Map);
                if (!Dev.IsNull(v_f)) {
                    var vfgeom = v_f.getGeometry();
                    vfgeom.translate(deltaX, deltaY);
                }
                var h_f = Dev.MapUtils.GetFeatureByID("hMarkerf", "tempGraphicLayer", Dev.App.Map);
                if (!Dev.IsNull(h_f)) {
                    var hfgeom = h_f.getGeometry();
                    hfgeom.translate(deltaX, deltaY);
                }
                var drag_f = Dev.MapUtils.GetFeatureByID("dragMarker", "tempGraphicLayer", Dev.App.Map);
                if (!Dev.IsNull(drag_f)) {
                    var dragfgeom = drag_f.getGeometry();
                    dragfgeom.translate(deltaX, deltaY);
                }
            };
            Dev.DragFeatures.prototype.handleUpEvent = function (evt) {
                var linef = Dev.MapUtils.GetFeatureByID("lineroutef", "tempGraphicLayer", Dev.App.Map);
                if (!Dev.IsNull(linef)) {
                    lineroutepoints = linef.getGeometry().getCoordinates();
                }
                lineroutepoints
                dragcoordinate_ = null;
                dragfeature_ = null;
                return false;
            };
        })(jQuery);
    </script>
    <style>
        .Submit {
            width: 150px;
            height: 36px;
            text-align: center;
            float: right;
            margin-right: 10px;
        }

            .Submit .Button {
                width: 70px;
                height: 28px;
                line-height: 28px;
                margin-top: 7px;
                background-color: #16dbbb;
                text-align: center;
                display: inline-block;
                margin-left: 2px;
            }

                .Submit .Button:hover {
                    background-color: #5227de;
                    cursor: pointer;
                }

                   .Submit .Button:active {
                background-color: #210097;
                cursor: pointer;
            }

        .drawbutton {
            width: 25px;
            height: 56px;
            background-color: #16dbbb;
            text-align: center;
            line-height: 13px;
            padding-top: 4px;
            color: #fff;
        }

            .drawbutton:hover {
                background-color: #5227de;
                cursor: pointer;
            }

        .disablebutton {
            background-color: #ddd;
            color: #808080;
            cursor: default;
        }

            .disablebutton:hover {
                background-color: #ddd;
            }
    </style>
</head>
<body>
    <div id="editDiv" style="width: 100%; height: 100%; position: relative;">
        <div style="width: 100%; height: 34px; line-height: 34px; border-bottom: 1px solid #ddd;">
            <div style="width: 80px; padding-right: 5px; text-align: right; display: inline-block; float: left; height: 34px; line-height: 34px;">任务名称</div>
            <div style="width: 628px; height: 34px; display: inline-block; margin-left: 5px; height: 34px; line-height: 34px;">
                <div class="save dev-textbox" name="name" data-name="任务名称" data-wordmax="18" maxlength="18" style="z-index: 3; width: 628px; margin-top: 4px;" opt='{"Required":true,"Height":26,"TipInfo":"18位以内","IsOverShow":true,"Padding":"0px 5px","TextAlign":"left","BodyCSS": { "background-color": "transparent" }}'></div>
            </div>
        </div>
        <div style="width: 100%; height: 34px; line-height: 34px; border-bottom: 1px solid #ddd;">
            <div style="width: 80px; padding-right: 5px; text-align: right; display: inline-block; float: left; height: 34px; line-height: 34px;">组织机构</div>
            <div id="orgcombotree" class="save combotree" name="orgid" data-name="组织机构" style="width: 269px; height: 34px; display: inline-block; margin-left: 5px; margin-top: 4px; height: 30px; line-height: 34px; float: left;">
            </div>
            <div style="width: 80px; padding-right: 5px; text-align: right; display: inline-block; float: left; height: 34px; line-height: 34px;">任务类型</div>
            <div style="width: 269px; height: 34px; display: inline-block; margin-left: 5px; height: 34px; line-height: 34px; float: left;">
                <div class="save dev-combobox" name="type" data-name="任务类型" style="z-index: 3; width: 269px; margin-top: 4px;" opt='{"Required":true,"Height":26,"TipInfo":"请选择","Data":["航测","喷药"],"IsOverShow":true,"Padding":"0px 5px","TextAlign":"left","BodyCSS": { "background-color": "transparent" }}'></div>
            </div>
        </div>
        <div style="width: 100%; height: 34px; line-height: 34px; border-bottom: 1px solid #ddd;">
            <div style="width: 80px; padding-right: 5px; text-align: right; display: inline-block; float: left; height: 34px; line-height: 34px;">任务类别</div>
            <div style="width: 269px; height: 34px; display: inline-block; margin-left: 5px; height: 34px; line-height: 34px; float: left;">
                <div class="save dev-combobox" name="category" data-name="任务类别" style="z-index: 3; width: 269px; margin-top: 4px;" opt='{"Required":true,"Height":26,"TipInfo":"请选择","Data":["计划任务","调度任务"],"IsOverShow":true,"Padding":"0px 5px","TextAlign":"left","BodyCSS": { "background-color": "transparent" }}'></div>
            </div>
            <div style="width: 80px; padding-right: 5px; text-align: right; display: inline-block; float: left; height: 34px; line-height: 34px;">任务接收人</div>
            <div style="width: 269px; height: 34px; display: inline-block; margin-left: 5px; height: 34px; line-height: 34px; position: relative;">
                <div id="receiveder" class="save easyui-combogrid" name="userid" data-name="任务接收人" style="margin-bottom: 4px" data-options="editable:false,height:26,width:269"></div>
                <div style="position: absolute; height: 10px; width: 10px; top: 12px; right: 20px; color: red; line-height: 10px;">*</div>
            </div>
        </div>
        <div style="width: 100%; height: 34px; line-height: 34px; border-bottom: 1px solid #ddd;">
            <div style="width: 80px; padding-right: 5px; text-align: right; display: inline-block; float: left; height: 34px; line-height: 34px;">无人机编号</div>
            <div style="width: 269px; height: 34px; display: inline-block; margin-left: 5px; height: 34px; line-height: 34px; float: left; position: relative;">
                <div id="uavno" class="save easyui-combogrid" name="no" data-name="无人机编号" data-options="editable:false,height:26,width:269"></div>
                <div style="position: absolute; height: 10px; width: 10px; top: 12px; right: 20px; color: red; line-height: 10px;">*</div>
            </div>
            <div style="width: 80px; padding-right: 5px; text-align: right; display: inline-block; float: left; height: 34px; line-height: 34px;">旁向重叠率</div>
            <div style="width: 269px; height: 34px; display: inline-block; margin-left: 5px; height: 34px; line-height: 34px; float: left;">
                <div class="save dev-numberbox" name="siderate" data-name="旁向重叠率" style="width: 269px; margin-top: 4px;" opt='{"Required":true,"Precision":0,"Min":0,"Max":500,"Suffix":" m","Height":26,"IsOverShow":true,"Padding":"0px 5px"}'></div>
            </div>
        </div>
        <div style="width: 100%; height: 34px; line-height: 34px; border-bottom: 1px solid #ddd;">
            <div style="width: 80px; padding-right: 5px; text-align: right; display: inline-block; float: left; height: 34px; line-height: 34px;">飞行高度</div>
            <div style="width: 269px; height: 34px; display: inline-block; margin-left: 5px; height: 34px; line-height: 34px; float: left;">
                <div class="save dev-numberbox" name="flyaltitude" data-name="飞行高度" style="width: 269px; margin-top: 4px;" opt='{"Required":true,"Precision":2,"Min":0,"Max":9999,"Suffix":" m","Height":26,"IsOverShow":true,"Padding":"0px 5px"}'></div>
            </div>
            <div style="width: 80px; padding-right: 5px; text-align: right; display: inline-block; float: left; height: 34px; line-height: 34px;">飞行速度</div>
            <div style="width: 269px; height: 34px; display: inline-block; margin-left: 5px; height: 34px; line-height: 34px;">
                <div class="save dev-numberbox" name="flyspeed" data-name="飞行速度" style="width: 269px; margin-top: 4px;" opt='{"Required":true,"Precision":2,"Min":0,"Max":9999,"Suffix":" km/h","Height":26,"IsOverShow":true,"Padding":"0px 5px"}'></div>
            </div>
        </div>
        <div style="width: 100%; height: 69px;border-bottom: 1px solid #ddd;position:relative;">
            <div style="width: 80px; padding-right: 5px; text-align: right; display: inline-block; float: left; height: 69px; line-height: 69px;">任务内容</div>
            <div style="width: 628px; height: 69px; display: inline-block; margin-left: 5px; height: 69px;">
                <div class="save dev-textbox" name="content" data-name="任务内容" data-wordmax="120" style="z-index: 2; width: 628px; height: 61px; margin-top: 4px;" opt='{"MaxLength":120,"Required":true,"TipInfo":"请输入任务内容(最大长度120位)","Type":"multi-text","IsOverShow":true,"Padding":"5px"}'></div>
            </div>
        </div>
        <div style="width: 100%; height: 69px; line-height: 69px; border-bottom: 1px solid #ddd;">
            <div style="width: 80px; padding-right: 5px; text-align: right; display: inline-block; float: left; height: 69px; line-height: 69px;">电子围栏</div>
            <div style="width: 597px; height: 69px; display: inline-block; margin-left: 5px; height: 69px; line-height: 69px; float: left;">
                <div class="save dev-textbox" name="fishnet" data-name="电子围栏" style="z-index: 2; width: 597px; height: 61px; margin-top: 4px;" opt='{"Readonly":true,"Required":true,"TipInfo":"请输入任务内容(最大长度256位)","Type":"multi-text","IsOverShow":true,"Padding":"5px"}'></div>
            </div>
            <div style="width: 25px; height: 61px; float: left; margin-top: 4px; margin-left: 6px;">
                <div class="drawbutton" tag="drawfishnet">绘</br>制</br>围</br>栏</div>
            </div>
        </div>
        <div style="width: 100%; height: 69px; line-height: 69px; border-bottom: 1px solid #ddd;">
            <div style="width: 80px; padding-right: 5px; text-align: right; display: inline-block; float: left; height: 69px; line-height: 69px;">作业路线</div>
            <div style="width: 597px; height: 69px; display: inline-block; margin-left: 5px; height: 69px; line-height: 69px; float: left;">
                <div class="save dev-textbox" name="route" data-name="作业线路" style="z-index: 2; width: 597px; height: 61px; margin-top: 4px;" opt='{"Readonly":true,"Required":true,"TipInfo":"请输入任务内容(最大长度256位)","Type":"multi-text","IsOverShow":true,"Padding":"5px"}'></div>
            </div>
            <div style="width: 25px; height: 61px; display: inline-block; margin-top: 4px; margin-left: 6px;">
                <div class="drawbutton disablebutton" tag="drawflyroute">生</br>成</br>路</br>线</div>
            </div>
            <!--<div class="Button" tag="tag1" style="background-color: #89a390;border: none;color: white;width: 40px;height: 60px;text-align: center;text-decoration: none;display: inline-block;font-size: 16px;margin: 4px 2px;cursor: pointer;border-radius: 8px;"></div>-->
            <!--<div class="button Button" tag="route" style="height: 58px; width: 38px;"></div>-->
        </div>
        <div style="width: 100%; height: 34px; line-height: 34px; border-bottom: 1px solid #ddd;">
            <div style="width: 80px; padding-right: 5px; text-align: right; display: inline-block; float: left; height: 34px; line-height: 34px;">开始时间</div>
            <div style="width: 269px; height: 34px; display: inline-block; margin-left: 5px; height: 34px; line-height: 34px; float: left; position: relative;">
                <div style="width: 269px; margin-top: 4px; height: 26px; line-height: 24px;">
                    <input id="starttime" class="save easyui-datetimebox" name="starttime" data-name="开始时间" data-options="editable:false,width:269,height:26" validType="timeCheck['#endtime']" />
                </div>
                <div style="position: absolute; height: 10px; width: 10px; top: 12px; right: 20px; color: red; line-height: 10px;">*</div>
            </div>
            <div style="width: 80px; padding-right: 5px; text-align: right; display: inline-block; float: left; height: 34px; line-height: 34px;">结束时间</div>
            <div style="width: 269px; height: 34px; display: inline-block; margin-left: 5px; height: 34px; line-height: 34px; position: relative;">
                <div style="width: 269px; margin-top: 4px; height: 26px; line-height: 24px;">
                    <input id="endtime" class="save easyui-datetimebox" name="endtime" data-name="结束时间" data-options="editable:false,width:269,height:26" validType="timeCheck['#starttime']" />
                </div>
                <div style="position: absolute; height: 10px; width: 10px; top: 12px; right: 20px; color: red; line-height: 10px;">*</div>
            </div>
        </div>
        <div style="width: 100%; height: 40px; line-height: 40px;">
            <div id="emsg" style="display: inline-block; line-height: 40px; height: 40px; width: 500px; margin-left: 15px; color: red; float: left;"></div>
            <div class="Submit">
                <div class="Button" tag="save">
                    <span style="line-height: 26px; color: #fcfcfc;">保&nbsp;&nbsp;存</span>
                </div>
                <div class="Button" tag="cancel">
                    <span style="line-height: 26px; color: #fcfcfc;">取&nbsp;&nbsp;消</span>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
