<!DOCTYPE html>
<html>
<head>
    <title>文件预览</title>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <script type="text/javascript" src="../js/jquery.min.js"></script>
    <style type="text/css">
        body {
            margin: 0px;
            top: 0px;
        }

        .outerContainer {
            background-color: #404040;
            background-image: url(../image/pdf/texture.png);
            overflow: hidden;
            position: absolute;
            left: 0px;
            top: 0px;
        }

            .outerContainer .mainContainer {
                position: absolute;
                top: 0;
                right: 0;
                bottom: 0;
                left: 0;
                min-width: 320px;
                -webkit-transition-duration: 200ms;
                -webkit-transition-timing-function: ease;
                transition-duration: 200ms;
                transition-timing-function: ease;
                overflow: hidden;
            }

            .outerContainer .toolbarViewer {
                position: absolute;
                width: 100%;
                height: 32px;
                background-color: #474747;
                background-image: url(../image/pdf/texture.png), linear-gradient(hsla(0,0%,32%,.99), hsla(0,0%,27%,.95));
                box-shadow: inset 1px 0 0 hsla(0,0%,100%,.08), inset 0 1px 1px hsla(0,0%,0%,.15), inset 0 -1px 0 hsla(0,0%,100%,.05), 0 1px 0 hsla(0,0%,0%,.15), 0 1px 1px hsla(0,0%,0%,.1);
            }

            .outerContainer #headerPreview {
                position: absolute;
                left: 5px;
                top: 0px;
                height: 100%;
                width: 100%;
                line-height: 32px;
                font-size: 15px;
                font-family: SimSuncss;
                font-weight: 700;
                color: rgb(180,180,180);
            }

            .outerContainer .dowload {
                position: absolute;
                right: 20px;
                top: 3px;
                width: 30px;
                height: 24px;
                background-image: url(../image/pdf/toolbarButton-download.png);
                background-repeat: no-repeat;
                background-position: center center;
                cursor: pointer;
                border: 1px solid transparent;
            }

            .outerContainer a[previewDownload]:hover {
                border: 1px solid rgb(41,41,41);
            }

            .outerContainer a[previewDownload]:active {
                border: 1px solid rgb(41,41,41);
                background-color: rgb(70,70,70);
            }

            .outerContainer .viewerContainer {
                overflow: visible;
                position: static;
                padding: 0;
                margin: 0;
                overflow: hidden;
                -webkit-overflow-scrolling: touch;
                position: absolute;
                top: 32px;
                right: 0;
                bottom: 0;
                left: 0;
                outline: none;
                background-color: white;
                box-shadow: inset 1px 0 0 hsla(0,0%,100%,.05);
                text-align: center;
            }
    </style>
    <script type="text/javascript">
        $(window).ready(function () {
            $('#mainPanel').width($(window).width());
            $('#mainPanel').height($(window).height());
            $(window).resize(function () {
                $('#mainPanel').width($(window).width());
                $('#mainPanel').height($(window).height());
            });
            var reluri = GetQueryString("reluri");
            var extname = reluri.substr(reluri.lastIndexOf('.'));
            if (extname.toLowerCase() == '.pdf') {
                $('#mainPanel').css("background-color", "#404040");
                $("#pdfViewer").attr("src", "pdf.html?file=../" + reluri);
            }
            else {
                $('#mainPanel').css("background-color", "white");
                $("#pdfViewer").attr("src", "../" + reluri);
            }
        });

        function GetQueryString(name) {
            var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
            var r = window.location.search.substr(1).match(reg);
            if (r != null) return unescape(r[2]); return null;
        }
    </script>
</head>
<body>
    <div id="mainPanel" class="outerContainer">
        <div class="mainContainer" style="display: none">
            <div class="toolbarViewer">
                <div id="headerPreview"></div>
                <a previewdownload="" class="dowload" href="../upload/dev.xls"></a>
            </div>
            <div class="viewerContainer">
                <iframe id="myTest" frameborder="0" scrolling="no" style="width: 100%; height: 100%"></iframe>
            </div>
        </div>
        <iframe id="pdfViewer" frameborder="0" style="width: 100%; height: 100%; display: block;overflow-y:auto;"></iframe>
    </div>
</body>
</html>
