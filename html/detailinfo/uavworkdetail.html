<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>详细信息</title>
    <link rel="stylesheet" href="../../theme/default/easyui.css"/>
    <link rel="stylesheet" type="text/css" href="../../theme/icon.css"/>
    <link rel="stylesheet" type="text/css" href="../../css/app.css"/>
    <link rel="stylesheet" type="text/css" href="../../css/main.css"/>
    <link rel="stylesheet" type="text/css" href="../../css/icon.css"/>
    <link type="text/css" href="../../css/dev.css" rel="stylesheet"/>
    <script type="text/javascript" src="../../js/jquery.min.js"></script>
    <script type="text/javascript" src="../../js/jquery.easyui.min.js"></script>
    <script type="text/javascript" src="../../js/easyui-lang-zh_CN.js"></script>
    <script type="text/javascript" src="../../js/data.util.js"></script>
    <script type="text/javascript" src="../../js/jquery.dev.control.js"></script>
    <style type="text/css">
       .detail-container{
           position: fixed;
           width: 100%;
           height: 100%;
           box-sizing: border-box;

       }

        .detail-row{
            position: relative;
            width: 100%;
            height: 35px;
            border-bottom: 1px solid #dddddd;
            line-height: 35px;
            text-align: center;
        }
        .detail-left {
            position: absolute;
            display: inline-block;
            left: 0;
            height: 100%;
            width: 50%;
        }
        .detail-right {
            position: absolute;
            display: inline-block;
            right: 0;
            height: 100%;
            width: 50%;
        }

        .detail-title{
            position: absolute;
            left: 0;
            height: 100%;
            width: 65px;
            border-left: 1px solid #dddddd;
            border-right: 1px solid #dddddd;

        }

        .detail-content{
            position: absolute;
            left: 65px;
            right: 0;
            height: 100%;
            padding: 0 10px;
            text-align: left;
            text-overflow: ellipsis;
            overflow: hidden;
            white-space: nowrap;
        }

    </style>

</head>

<body style="height: 100%; width: 100%">

<div class="detail-container">
    <div class="detail-row">
        <div class="detail-title">任务名称</div>
        <div name="name" class="detail-content detailval"  title=""></div>
    </div>
    <div class="detail-row">
        <div class="detail-left">
            <div class="detail-title">组织机构</div>
            <div name="org_name" class="detail-content detailval" title=""></div>
        </div>
        <div class="detail-right">
            <div class="detail-title">任务类型</div>
            <div name="type" class="detail-content detailval" title=""></div>
        </div>
    </div>
    <div class="detail-row">
        <div class="detail-left">
            <div class="detail-title">任务类别</div>
            <div name="category" class="detail-content detailval" title=""></div>
        </div>
        <div class="detail-right">
            <div class="detail-title">任务接收人</div>
            <div name="user_name" class="detail-content detailval" title=""></div>
        </div>
    </div>
    <div class="detail-row">
        <div class="detail-left">
            <div class="detail-title">无人机编号</div>
            <div name="no" class="detail-content detailval" title=""></div>
        </div>
        <div class="detail-right">
            <div class="detail-title">旁向重叠率</div>
            <div name="siderate" class="detail-content detailval" title=""></div>
        </div>
    </div>
    <div class="detail-row">
        <div class="detail-left">
            <div class="detail-title">飞行高度</div>
            <div name="flyaltitude" class="detail-content detailval" title=""></div>
        </div>
        <div class="detail-right">
            <div class="detail-title">飞行速度</div>
            <div name="flyspeed" class="detail-content detailval" title=""></div>
        </div>
    </div>
    <div class="detail-row" style="height: 40px">
        <div class="detail-title"  style="line-height: 40px">任务内容</div>
        <div class="detail-content" title="">
            <textarea name="content" readonly="readonly" style="width: 100%;height: 100%;"></textarea>
        </div>
    </div>
    <div class="detail-row"  style="height: 40px">
        <div class="detail-title" style="line-height: 40px">电子围栏</div>
        <div class="detail-content" title="">
            <textarea name="fishnet" readonly="readonly" style="width: 100%;height: 100%;"></textarea>
        </div>
    </div>
    <div class="detail-row"  style="height: 40px">
        <div class="detail-title"  style="line-height: 40px">作业路线</div>
        <div class="detail-content" title="">
            <textarea name="route" readonly="readonly" style="width: 100%;height: 100%;"></textarea>
        </div>
    </div>
    <div class="detail-row">
        <div class="detail-left">
            <div class="detail-title">开始时间</div>
            <div name="starttime" class="detail-content detailval" title=""></div>
        </div>
        <div class="detail-right">
            <div class="detail-title">结束时间</div>
            <div name="endtime" class="detail-content detailval" title=""></div>
        </div>
    </div>

</div>

<script type="text/javascript">
    var Dev = window.top.window.dev;
    var parent;

    function WidgetCommunication(s) {//部件通讯
        parent = s.parent;
        var showdata = s.param.showdata;
        $(".detailval").each(function (index, dom) {
            var name = $(this).attr("name");
            if (name === "org_name") {
                getOrgnameById(showdata["orgid"], $(dom));
                return true}
            if (name === "user_name") {
                getusernameById(showdata["userid"], $(dom));
                return true;
            }
            if (name === "starttime" || name === "endtime" ) {
                var time;
                if (Dev.IsNull(showdata[name])) {time = "";}
                else {time = dateToStrExcat(new Date(showdata[name]), "-");}
                $(this).text(time);
                return true;
            }
            if (name === "siderate") { $(this).text(showdata[name]+" m"); return true;}
            if (name === "flyaltitude") { $(this).text(showdata[name]+" m"); return true;}
            if (name === "flyspeed") { $(this).text(showdata[name]+" km/h"); return true;}
            $(this).text(showdata[name]);


        });
        $("textarea").each(function () {
            var name = $(this).attr("name");
            this.value = showdata[name];
        });
        parent.one("onClosing", function () {


        });


    }

    function getOrgnameById(orgid, $this) {
        var url = Dev.GetSystemUrlByRelID("Service") + "organize/getOrganizeNameById/" + orgid;
        $.ajax({
            url: url,
            type: "get",
            dataType: 'json',
            success: function (result) {
                const orgname = result.data;
                $this.text(orgname);
                $this.attr("title", orgname);

            }
        });
    }
    function getusernameById(userid, $this) {
        var url = Dev.GetSystemUrlByRelID("Service") + "user/getbyid/"+userid;
        $.ajax({
            url: url,
            type: "get",
            dataType: 'json',
            success: function (result) {
                if (Dev.IsNull(result) || Dev.IsNull(result.data)) {
                    return;
                }
                var truename = result.data.truename;
                $this.text(truename);
            }
        });
    }
    function dateToStr(date) {
        var time = date.getFullYear() + "-";
        if (date.getMonth() + 1 < 10) {
            time += "0" + (date.getMonth() + 1) + "-";
        } else {
            time += (date.getMonth() + 1) + "-";
        }
        if (date.getDate() < 10) {
            time += "0" + date.getDate();
        } else {
            time += date.getDate();
        }
        return time;
    }

    function dateToStrExcat(date, sign) {
        var time = dateToStr(date, "/");
        var hours = (date.getHours() < 10 ? "0" : "") + date.getHours();
        var minute = (date.getMinutes() < 10 ? "0" : "") + date.getMinutes();
        var second = (date.getSeconds() < 10 ? "0" : "") + date.getSeconds();
        return time + " " + hours + sign + minute + sign + second;
    }

</script>
</body>
</html>
