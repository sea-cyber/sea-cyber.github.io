<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>详细信息</title>
    <link rel="stylesheet" href="../../theme/default/easyui.css" />
    <link rel="stylesheet" type="text/css" href="../../theme/icon.css" />
    <link rel="stylesheet" type="text/css" href="../../css/app.css" />
    <link rel="stylesheet" type="text/css" href="../../css/main.css" />
    <link rel="stylesheet" type="text/css" href="../../css/icon.css" />
    <link type="text/css" href="../../css/dev.css" rel="stylesheet" />
    <script type="text/javascript" src="../../js/jquery.min.js"></script>
    <script type="text/javascript" src="../../js/jquery.easyui.min.js"></script>
    <script type="text/javascript" src="../../js/easyui-lang-zh_CN.js"></script>
    <script type="text/javascript" src="../../js/data.util.js"></script>
    <script type="text/javascript" src="../../js/jquery.dev.control.js"></script>
    <style type="text/css">
        .content .Button {
            width: 70px;
            height: 26px;
            float: left;
            margin-top: 7px;
            background-color: #03afD9;
            text-align: center;
            border: 1px solid #03afD9;
            display: inline-block;
            margin-left: 5px;
        }
    </style>
    <script type="text/javascript">
        var Dev = window.top.window.dev;
        var parent;
        var AGRI_PROGRAMME_TYPE = {
            ONE: "一年一熟",
            MORE: "一年多熟"
        };
        function WidgetCommunication(s) {//部件通讯
            parent = s.parent;
            var showdata = s.param.showdata;

            //初始化信息选项卡
            initTab(showdata);
            parent.one("onClosing", function () {
                //进行释放
            });
        }
        //初始化所有详细信息选项卡
        function initTab(showdata) {
            /*            $(".rotations").empty();
                        var items = [{ID: "programmeTab1", Name: "方案详细信息", Content: $("#programmeTab"),Width: $(window).width() - 2, Height: $(window).height() - 26}];
                        var tabControl = new Dev.Tab({
                            Width: $(window).width(),
                            Height: $(window).height(),
                            TabNormalCls: "liveNormalTabCls",
                            TabSelectedCls: "liveSelectedTabCls",
                            Items: items
                        });
                        $(".rotations").append(tabControl.Target);
                        tabControl.Layout();*/
            loadShowdata(showdata);
            loadRules(showdata);
        }
        //加载方案信息
        function loadShowdata(showdata) {
            var url = Dev.GetSystemUrlByRelID("Service") + "organize/getbyid/" + showdata.orgid;
            $.ajax({
                url: url,
                type: "GET",
                contentType: 'application/json',
                success: function (result) {
                    if (result.statusCode != 200 || Dev.IsNull(result.data)) return;
                    var _organizename = result.data.name;
                    $(".programmeTab[name='_organizename']").text(_organizename);
                }
            });
            showdata._address = getAddr(showdata);
            var programmeDivs = $(".programmeTab");
            for (var i = 0; i < programmeDivs.length; i++) {
                var curName = $(programmeDivs[i]).attr("name");
                var value = showdata[curName];
                if (curName == "createdate" || curName == "updatedate") {
                    value = Dev.IsNull(value) ? "-" : Dev.GetDateString(value);
                }
                if (curName == "programmename") { $(programmeDivs[i]).attr("title", value) }
                $(programmeDivs[i]).text(value);
            }
        }
        //加载轮作规则
        function loadRules(showdata) {
            var $rule = $("#ruleTab1");
            if (showdata.type == AGRI_PROGRAMME_TYPE.MORE) { $rule = $("#ruleTab2") }
            for (var i = 0; i < showdata.list.length - 1; i++) {
                $(".row:first", $rule).clone().appendTo($rule);
            }
            var ruleDivs = $(".ruleTab", $rule);
            var index = 0;
            for (var i = 0; i < ruleDivs.length; i++) {
                var curname = $(ruleDivs[i]).attr("name");
                var value = showdata.list[index][curname];
                $(ruleDivs[i]).text(value);
                if (curname == "crop") { index += 1; }
            }
            $rule.appendTo("#programmeTab");
        }
        //行政区拼接为地址
        function getAddr(showdata) {
            var _address = "";
            if (!Dev.IsNullAll(showdata.province)) { _address += showdata.province; }
            if (!Dev.IsNullAll(showdata.city)) { _address += showdata.city; }
            if (!Dev.IsNullAll(showdata.county)) { _address += showdata.county; }
            if (!Dev.IsNullAll(showdata.town)) { _address += showdata.town; }
            if (!Dev.IsNullAll(showdata.village)) { _address += showdata.village; }
            return _address;
        }
    </script>
</head>
<body style="height: 100%; width: 100%">
    <!--<div class="rotations"></div>-->
    <!--方案详细信息-->
    <div id="programmeTab" style="height: 100%; width: 100%; overflow-y: auto;">
        <div style="height: 32px; width: 100%; border-bottom: 1px solid #ddd;">
            <div style="height: 100%; width: 100%; display: inline-block; float: left; position: relative;">
                <div style="width: 80px; text-align: right; padding-right: 5px; display: inline-block; border-right: 1px solid #ddd; border-left: 1px solid #ddd; line-height: 32px; float: left;">
                    方案名称
                </div>
                <div class="programmeTab" name="programmename"
                    style="width: 348px; height: 100%; text-align: left; padding-left: 5px; display: inline-block; line-height: 32px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; float: left;">
                </div>
            </div>
        </div>
        <div style="height: 32px; width: 100%; border-bottom: 1px solid #ddd;">
            <div style="height: 100%; width: 50%; display: inline-block; float: left; position: relative;">
                <div style="width: 80px; text-align: right; padding-right: 5px; display: inline-block; border-right: 1px solid #ddd; border-left: 1px solid #ddd; line-height: 32px; float: left;">
                    方案类型
                </div>
                <div class="programmeTab" name="type"
                    style="width: 128px; height: 100%; text-align: left; padding-left: 5px; display: inline-block; line-height: 32px; float: left;">
                </div>
            </div>
        </div>
        <div style="height: 32px; width: 100%; border-bottom: 1px solid #ddd;">
            <div style="height: 100%; width: 100%; display: inline-block; float: left; position: relative;">
                <div style="width: 80px; text-align: right; padding-right: 5px; display: inline-block; border-right: 1px solid #ddd; border-left: 1px solid #ddd; line-height: 32px; float: left;">
                    方案内容
                </div>
                <div class="programmeTab" name="programmecontent"
                    style="width: 348px; height: 100%; text-align: left; padding-left: 5px; display: inline-block; line-height: 32px; float: left;">
                </div>
            </div>
        </div>
        <div style="height: 32px; width: 100%; border-bottom: 1px solid #ddd;">
            <div style="height: 100%; width: 100%; display: inline-block; float: left; position: relative;">
                <div style="width: 80px; text-align: right; padding-right: 5px; display: inline-block; border-right: 1px solid #ddd; border-left: 1px solid #ddd; line-height: 32px; float: left;">
                    组织机构
                </div>
                <div class="programmeTab" name="_organizename"
                    style="width: 348px; height: 100%; text-align: left; padding-left: 5px; display: inline-block; line-height: 32px; float: left;">
                </div>
            </div>
        </div>
        <div style="height: 32px; width: 100%; border-bottom: 1px solid #ddd">
            <div style="height: 100%; width: 100%; display: inline-block; float: left; position: relative;">
                <div style="width: 80px; text-align: right; padding-right: 5px; display: inline-block; border-right: 1px solid #ddd; border-left: 1px solid #ddd; line-height: 32px; float: left;">
                    详细地址
                </div>
                <div class="programmeTab" name="_address" style="width: 348px; height: 100%; text-align: left; padding-left: 5px; display: inline-block; line-height: 32px; float: left;"></div>
            </div>
        </div>
        <div style="height: 45px; width: 100%; border-bottom: 1px;">
            <div style="height: 100%; width: 100%; display: inline-block; float: left; position: relative;">
                <div style="width: 80px; text-align: right; padding-right: 5px; display: inline-block; border-right: 1px solid #ddd; border-left: 1px solid #ddd; line-height: 45px; float: left;">
                    备注
                </div>
                <div class="programmeTab" name="remark" style="width: 348px; height: 100%; text-align: left; padding-left: 5px; display: inline-block; line-height: 20px; float: left;"></div>
            </div>
        </div>
        <div style="height: 30px; width: 100%; border-bottom: 1px; background-color: #DDDDDD">
            <div style="letter-spacing: 4px; float: left; line-height: 30px; text-align: center; width: 100%;">
                轮作规则
            </div>
        </div>
         <!--一年一熟-->
        <div id="ruleTab1" style="width: 100%;">
            <div style="height: 32px; width: 100%; border-bottom: 1px solid #ddd;">
                <div class="head" style="height: 100%; width: 50%; display: inline-block; float: left; position: relative;">
                    <div style="width: 100%; text-align: center; display: inline-block; border-right: 1px solid #ddd; line-height: 32px; float: left;">
                        年份
                    </div>
                </div>
                <div style="height: 100%; width: 50%; display: inline-block; float: left; position: relative;">
                    <div style="width: 100%; text-align: center; display: inline-block; line-height: 32px; float: left;">
                        作物
                    </div>
                </div>
            </div>
            <div class="row" style="height: 32px; width: 100%; border-bottom: 1px solid #ddd;">
                <div style="height: 100%; width: 50%; display: inline-block; float: left; position: relative;">
                    <div class="ruleTab" name="year" style="width: 100%; text-align: center; display: inline-block; border-right: 1px solid #ddd; line-height: 32px; float: left;"></div>
                </div>
                <div style="height: 100%; width: 50%; display: inline-block; float: left; position: relative;">
                    <div class="ruleTab" name="crop" style="width: 100%; text-align: center; display: inline-block; line-height: 32px; float: left;"></div>
                </div>
            </div>
        </div>
    </div>
      <!--一年多熟-->
        <div id="ruleTab2" style="width: 100%;">
            <div class="head" style="height: 32px; width: 100%; border-bottom: 1px solid #ddd;">
                <div style="height: 100%; width: 33%; display: inline-block; float: left; position: relative;">
                    <div style="width: 100%; text-align: center; display: inline-block; border-right: 1px solid #ddd; line-height: 32px; float: left;">
                        年份
                    </div>
                </div>
                <div style="height: 100%; width: 33%; display: inline-block; float: left; position: relative;">
                    <div style="width: 100%; text-align: center; display: inline-block; border-right: 1px solid #ddd; line-height: 32px; float: left;">
                        月份
                    </div>
                </div>
                <div style="height: 100%; width: 33%; display: inline-block; float: left; position: relative;">
                    <div style="width: 100%; text-align: center; display: inline-block; line-height: 32px; float: left;">
                        作物
                    </div>
                </div>
            </div>
            <div class="row" style="height: 32px; width: 100%; border-bottom: 1px solid #ddd;">
                <div style="height: 100%; width: 33%; display: inline-block; float: left; position: relative;">
                    <div class="ruleTab" name="year" style="width: 100%; text-align: center; display: inline-block; border-right: 1px solid #ddd; line-height: 32px; float: left;"></div>
                </div>
                <div style="height: 100%; width: 33%; display: inline-block; float: left; position: relative;">
                    <div class="ruleTab" name="mouth" style="width: 100%; text-align: center; display: inline-block; border-right: 1px solid #ddd; line-height: 32px; float: left;"></div>
                </div>
                <div style="height: 100%; width: 33%; display: inline-block; float: left; position: relative;">
                    <div class="ruleTab" name="crop" style="width: 100%; text-align: center; display: inline-block; line-height: 32px; float: left;"></div>
                </div>
            </div>
        </div>
</body>
</html>
