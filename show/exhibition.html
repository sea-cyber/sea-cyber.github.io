<!DOCTYPE>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>农业大数据研究与管理平台</title>
    <link rel="stylesheet" href="../theme/default/easyui.css" />
    <link rel="stylesheet" type="text/css" href="../css/app.css" />
    <link rel="stylesheet" type="text/css" href="../css/main.css" />
    <link type="text/css" href="../css/dev.css" rel="stylesheet" />
    <link rel="stylesheet" type="text/css" href="../cesium/Widgets/widgets.css" />
    <link href="../js/viewer.min.css" rel="stylesheet" />
    <script type="text/javascript" src="../js/jquery.min.js"></script>
    <script type="text/javascript" src="../js/jquery.easyui.min.js"></script>
    <script type="text/javascript" src="../js/dev.ui.js"></script>
    <script type="text/javascript" src="../js/data.util.js"></script>
    <script type="text/javascript" src="../js/ol.min.3.2.1.js"></script>
    <script type="text/javascript" src="js/show.gis.js"></script>
    <script type="text/javascript" src="../js/linq.min.js"></script>
    <script type="text/javascript" src="../js/guid.js"></script>
    <script type="text/javascript" src="../js/jquery.dev.js"></script>
    <script type="text/javascript" src="../cesium/Cesium.js"></script>
    <script type="text/javascript" src="../js/jquery.cookie.js"></script>
    <script type="text/javascript" src="../js/measure3D.js"></script>
    <script type="text/javascript" src="../cesium/viewerNavigation.js"></script>
    <script type="text/javascript" src="js/highcharts.js"></script>
    <script type="text/javascript" src="js/variable-pie.js"></script>
    <script type="text/javascript" src="../streetview/three.min.js"></script>
    <script type="text/javascript" src="../streetview/tpanorama.js"></script>
    <script type="text/javascript" src="js/highcharts-3d.js"></script>
    <script type="text/javascript" src="../js/viewer.js"></script>
    <link rel="icon" type="image/x-icon" href="../image/logo.ico" />
    <style type="text/css">
        .content {
            width: 100%;
            height: calc(100% - 33px);
            background: url(showimg/logo.png) no-repeat top,-webkit-radial-gradient(#000c09 30%,#000c09 70%);
            background: url(showimg/logo.png) no-repeat top,-o-radial-gradient(#000c09 30%,#000c09 70%);
            background: url(showimg/logo.png) no-repeat top,-moz-radial-gradient(#000c09 30%,#000c09 70%);
            background: url(showimg/logo.png) no-repeat top,radial-gradient(#000c09 30%,#000c09 70%);
        }

        .fillpanel {
            width: 100%;
            height: 100%;
            display: none;
            position: absolute;
            top: 0;
        }

        .content > div {
            float: left;
            width: 45%;
            height: calc(60% - 62px);
            background: url(showimg/topl.png),url(showimg/topr.png),url(showimg/bottoml.png),url(showimg/bottomr.png),url(showimg/divbg.png) no-repeat center/100% 100%;
            background-repeat: no-repeat,no-repeat,no-repeat,no-repeat;
            background-position: top left,top right,bottom left,bottom right;
            margin-left: 1%;
            margin-top: 110px;
        }

        #information {
            float: left;
            width: 20%;
            height: calc(60% - 5px);
            margin-left: 1%;
            background: url();
            background-color: transparent;
            margin-top: 53px;
        }

        .tldiv {
            height: 30%;
            width: 100%;
            border-bottom: 1px solid #0a6d5b;
            font-size: 12px;
            float: left;
            color: #00CED1;
            line-height: 30px;
        }

        .title {
            float: left;
            width: 97%;
            height: 30px;
            background: url(showimg/t-bg.png) no-repeat center/100% 100%;
            margin-left: 1%;
            margin-top: 1%;
            color: white;
            padding-left: 6px;
            line-height: 30px;
        }

        .leftpanel > .mappanel {
            float: left;
            margin-left: 3px;
            width: calc(100% - 6px);
            height: calc(100% - 44px);
            background-color: transparent;
            position: relative;
        }

        .mappaneldom {
            float: left;
            width: 100%;
            height: 100%;
            display: inline-block;
        }

        .mappanel3d {
            width: 100%;
            height: 100%;
            display: none;
        }

        .street {
            width: 100%;
            height: 100%;
            display: none;
        }

        .columdiv1 {
            width: 70%;
            height: calc(100% - 44px);
            background: url(showimg/Statistic.png) no-repeat center/100% 100%,url(showimg/stbg.png) no-repeat top/100%;
            float: left;
            margin-top: 0.5%;
        }

        .attribute {
            width: 25%;
            height: calc(100% - 44px);
            background-color: transparent;
            float: left;
            margin-left: 3%;
        }

        .attribute1 {
            width: 90%;
            height: 25%;
            background: url(showimg/titelbg.png) no-repeat center/100% 100%;
            float: left;
            margin-top: 5%;
            text-align: center;
        }

        #massifdiv table, #framerdiv table, #histroydiv table {
            border: 0;
            height: 100%;
            width: 100%;
            color: #0b86ee;
            cellspacing: 0;
            cellpadding: 0;
            table-layout: fixed;
            font-size: 12px;
        }

        table td:nth-child(odd) {
            width: 30%;
            /*text-align: center;*/
            padding-left: 5%;
        }

        table td:nth-child(even) {
            color: #82cbff;
            text-align: left;
        }

        #massifdiv table td, #framerdiv table td, #histroydiv table td {
            padding-top: 1.5%;
            word-break: keep-all; /* 不换行 */
            white-space: nowrap; /* 不换行 */
            overflow: hidden; /* 内容超出宽度时隐藏超出部分的内容 */
            text-overflow: ellipsis; /* 当对象内文本溢出时显示省略标记(...) ；需与overflow:hidden;一起使用*/
        }

        .ol-default-popup {
            position: absolute;
            background-color: white;
            -webkit-filter: drop-shadow(0 1px 4px rgba(0,0,0,0.2));
            filter: drop-shadow(0 1px 4px rgba(0,0,0,0.2));
            padding: 5px;
            border-radius: 10px;
            border: 1px solid #cccccc;
            bottom: 12px;
            left: -50px;
        }

            .ol-default-popup:after, .ol-popup:before {
                top: 100%;
                border: solid transparent;
                content: " ";
                height: 0;
                width: 0;
                position: absolute;
                pointer-events: none;
            }

            .ol-default-popup:after {
                border-top-color: white;
                border-width: 10px;
                left: 70px;
                margin-left: -10px;
            }
        /* 底部样式 */
        footer {
            background-color: #363636;
            font-size: 14px;
            color: #fff;
            line-height: 33px;
            position: relative;
            bottom: 0;
            left: 0;
            right: 0;
            width: 100%;
            height: 33px;
            text-align: center;
        }
    </style>
    <script type="text/javascript">
        var Config, exMap, streetview, cropl, mapclick, polygonkey, mas, framer, hist;
        var prop, Interval1;
        var idl;
        var isadmin;
        var rsp;
        var layerconfig;
        var newsrc;
        $(window).ready(function () {
            var u = $.cookie("usertoken");
            var data = getUrlParam("prodata");
            idl = getUrlParam("index");
            newsrc = getUrlParam("newsrc");
            dev.App.MapPanel = $(".mappanel");
            dev.App.MapPanel.Target = $(".mappanel");
            dev.App.FillPanel = new dev.FillPanel($(".fillpanel"));
            dev.App.MapPanel.MapDOM = $(".mappaneldom");
            dev.App.MapPanel.MapDOM3D = $(".mappanel3d");
            dev.App.MapPanel.MapStreet = $(".content");
            if (dev.IsNull(Config)) {
                var config = null;
                $.ajax({
                    url: "../config/app.xml",
                    dataType: 'xml',
                    type: 'GET',
                    cache: false,
                    timeout: 2000,
                    async: false,
                    error: function (xml) {
                        alert("加载系统配置文件出错！");
                    },
                    success: function (xml) {
                        config = $.xml2json(xml);
                    }
                });
                dev.App.Config = Config = config;
                layerconfig = Config.Extend.LayerForTree.LayerRoot[1].Child;
            }
            layer = getlayertreebyType("fine");
            Config.SystemMap.DisplayEPSG = newsrc;
            initMap();
            dev.App.Map = exMap;
            dev.InitSMap3D(Config);
            dev.projTransf();
            dev.MapLoad.InitMapSwitch(Config, $(".mappanel"));
            initlayer();
            dev.App.Root = GetRootPath();
            dev.App.TempStyle = dev.CreateTempStyle();
            dev.App.InitMapMenu();
            dev.App.EventObject = $(dev);
            var user = JSON.parse(u);
            isadmin = (user.posts[0].postowner == 1 && user.posts[0].mainpost == 1);
            //二三维切换
            dev.App.MapSwitch.Target.bind("onSwitchClick", function (sender, opt) {
                if (dev.IsNull(opt)) return;
                featureclear();
                if (!dev.IsNull(streetview)) streetview.Clear();
                if (opt.type == "StreetView") {
                    dev.App.MapPanel.MapDOM3D.css("display", "none");
                    $('.mappaneldom').css({ "width": "100%", "display": "block" });
                    streetview = new dev.ShowStreetView();
                    streetview.LoadStreet();
                }
                else if (opt.type == "PotreeMap") {
                    $('.fillpanel').css({ "display": "block" });
                    dev.App.FillPanel.Add(GetRootPath() + "html/potreeview.html", null, "potreeviewframe");
                }
                else if (opt.type == "MonitorMap") {
                    $.ajax({
                        url: dev.MapLoad.GetUrlByRelID("Service") + "amstation/getall",
                        type: "Get",
                        contentType: 'application/json',
                        success: function (result) {
                            if (result.statusCode != 200 || result.data.length == 0) return;
                            showmonitor(result.data);
                        }
                    });
                }
                else {
                    if (opt.type == "3D") {
                        $('.mappaneldom').css({ "width": "100%", "display": "none" });
                        dev.App.MapPanel.MapDOM3D.css({ "width": "100%", "display": "block" });
                    }
                    else if (opt.type == "2D") {
                        $('.mappaneldom').css({ "width": "100%", "display": "block" });
                        dev.App.MapPanel.MapDOM3D.css("display", "none");
                    }
                    else if (opt.type == "Unit") {
                        $('.mappaneldom').css({ "width": "50%", "display": "block" });
                        dev.App.MapPanel.MapDOM3D.css({ "width": "50%", "display": "block", "float": "left" });
                    }
                }
                exMap.updateSize();
                //$("#" + opt.did, $(".content")).css({ "border": "1px solid 	#1E90FF" });
            });
            resize();
            if (!dev.IsNull(data)) {
                detailedclick(null, data);
            }
            mapclick = exMap.on('singleclick', function (evt) {
                $(".attribute1").html("");
                if (!dev.IsNull($('#colum5').highcharts())) {
                    $('#colum5').highcharts().destroy();
                }
                if (!dev.IsNull($('#colum6').highcharts())) {
                    $('#colum6').highcharts().destroy();
                }
                if (!dev.IsNull($('#colum3').highcharts())) {
                    $('#colum3').highcharts().destroy();
                }
                if (!dev.IsNull($('#colum4').highcharts())) {
                    $('#colum4').highcharts().destroy();
                }
                if (!dev.IsNull($('#colum2').highcharts())) {
                    $('#colum2').highcharts().destroy();
                }
                if ((evt.map != exMap)) return;
                var ft;
                //var mapproj = dev.App.Map.getView().getProjection();
                //if (mapproj.getCode() != dev.App.Config.SystemMap.DataEPSG) evt.coordinate = ol.proj.transform(evt.coordinate, mapproj.getCode(), dev.App.Config.SystemMap.DataEPSG);
                var pixel = this.getPixelFromCoordinate(evt.coordinate);
                exMap.forEachFeatureAtPixel(pixel, function (feature) {
                    if (dev.IsNull(feature) || dev.IsNull(feature.getProperties().indepeid) || (!dev.IsNull(feature.f) && feature.f.indexOf("streeview") >= 0)) return;
                    var indepeid = feature.getProperties().indepeid;
                    var serialnumber = feature.getProperties().serialnumber;
                    window.open(GetRootPath() + "show/metedata.html?indepeid=" + indepeid + "&serialnumber=" + serialnumber, "_self");
                    ft = true;
                });
                if (ft) return;
                detailedclick(evt.coordinate);
            });
            $('#infobtn').click(function () {
                //window.close();
                window.open(GetRootPath() + "show/index.html", "_self");
            });
        });
        $(window).resize(function () {
            resize();
        });
        $(window).unload(function () {
            $(this).remove();
        });
        function resize() {
            if ($('.content').height() <= 870) {
                $('#flow').css("overflow-y", "auto");
            }
            if ($('.content').width() <= 1300) {
                $('#flow').css("overflow-x", "auto");
            }
            $('footer').css("width", $('.content').width());
        }
        //初始化地图
        function initMap() {
            var initconfig = Config.SystemMap;
            var resolutions;
            if (!dev.IsNull(initconfig.LevelInfo) && !dev.IsNull(initconfig.LevelInfo.IsVisibleLevel)
                && initconfig.LevelInfo.IsVisibleLevel == "true") {
                resolutions = [];
                if (dev.IsNull(initconfig.DisplayEPSG)) initconfig.DisplayEPSG = "EPSG:4326";
                for (var i = 0; i < initconfig.LevelInfo.Levels.length; i++)
                    if (dev.IsNull(initconfig.DisplayEPSG) || initconfig.DisplayEPSG == "EPSG:4326") resolutions.push(parseFloat(initconfig.LevelInfo.Levels[i].Resolution));
                    else resolutions.push(parseFloat(initconfig.LevelInfo.Levels[i].Resolution3857));
            }

            exMap = new ol.Map({
                controls: new ol.control.defaults({ zoom: false, rotate: false, attribution: false }),
                interactions: ol.interaction.defaults().extend([new ol.interaction.DragRotateAndZoom()]),
                target: $(".mappaneldom")[0],
                logo: false
            });
            var minZoom = parseInt(initconfig.LevelInfo.MinZoom);
            var proj = ol.proj.get(initconfig.DisplayEPSG);
            exMap.setView(new ol.View({
                projection: proj,
                resolutions: resolutions,
                minZoom: minZoom,
                minResolution: resolutions[resolutions.length - 1],
                maxZoom: resolutions.length + minZoom - 1,
                maxResolution: resolutions[0]
            }));
            dev.App.Map = exMap;
            dev.MapLoad.InitMap($.extend({ Map: exMap }, initconfig));
        }
        function initlayer() {
            for (var i = 0; i < layer.length; i++) {
                var province1 = $("<div class='pro' id='" + i + "pro' style='position: absolute;width:110px;height:44px;background: url(showimg/nocheck.png) no-repeat;top: calc(" + 12 * (i) + "% + 5px);left: 10px;font-size: 16px; color: white; border-radius: 4px;background-size: 100% 100%;cursor: pointer;padding-left:8px;line-height: 44px;'>" + layer[i].Text + "</div>").appendTo($('.mappanel'));
                province1.mouseover(function () {
                    var id = $(this).attr("id");
                    $("#" + id).css({ "opacity": "0.8", "filter": "alpha(opacity:80)" });
                }).mouseleave(function () {
                    var id = $(this).attr("id");
                    $("#" + id).css({ "opacity": "1", "filter": "alpha(opacity:100)" });
                }).click(function () {
                    $(".pro").css({ "background": "url(showimg/nocheck.png) no-repeat", "background-size": "100% 100%" });
                    var id = $(this).attr("id");
                    selectlayer(id);
                });
            }
            selectlayer(idl + "pro");
        }
        function selectlayer(id) {
            $("#" + id).css({ "background": "url(showimg/check.png) no-repeat", "background-size": "100% 100%" });
            $(".title", $(".leftpanel")).text($("#" + id)[0].innerText);
            var indexl = parseInt(id.replace('pro', ''));
            if (dev.IsNull(layer[indexl].Child[0]) || dev.IsNull(layer[indexl].Child[0].Child[0]) || dev.IsNull(layer[indexl].Child[0].Child[0].Child)) {
                return;
            }
            alllayer = layer[indexl].Child[0].Child[0].Child;
            cropl = alllayer[0];
            AddWMS(cropl, true);
            var threemodel = Enumerable.From(alllayer).Where('s=>s.Type.indexOf("threemodel")>=0').ToArray();
            if (!dev.IsNull(threemodel) && threemodel.length > 0 && !dev.IsNull(threemodel[0].Child)) {
                var l3d = threemodel[0].Child;
                if (!dev.IsNull(l3d) && l3d.length > 0) {
                    for (var i = 0; i < l3d.length; i++) {
                        dev.Map3DUtils.Remove3DTileLayer(l3d[i].Value);
                        var tempdata = dev.ObjClone(l3d[i]);
                        tempdata.Url = dev.MapLoad.GetUrlByRelID(tempdata.Url);
                        dev.Map3DUtils.Add3DTileLayer(tempdata);
                    }
                }
            }
        }
        //添加WMS
        function AddWMS(layerinfo, visible) {
            //判断该图层是否存在
            dev.MapUtils.RemoveLayer(layerinfo.Value, dev.App.Map);
            var param = {
                Map: dev.App.Map,
                ID: layerinfo.Value,
                Url: dev.MapLoad.GetUrlByRelID(layerinfo.Url),
                Layers: layerinfo.TypeName,
                Visible: dev.IsNull(visible) ? false : visible,
                ServerType: layerinfo.ServerType,
                EPSG: dev.App.Map.getView().getProjection().getCode()
            };
            if (!dev.IsNull(layerinfo.SldLegend)) {
                if (dev.IsNull(layerinfo.SldLegend.length)) layerinfo.SldLegend = [layerinfo.SldLegend];
                param.Sldbody = dev.MapLoad.GetSLDString(layerinfo.TypeName, dev.LegendToRule(layerinfo.SldLegend));
            }
            if (!dev.IsNull(layerinfo.Envelop)) {
                var arry = layerinfo.Envelop.split(',');
                param.Extent = [parseFloat(arry[0]), parseFloat(arry[1]), parseFloat(arry[2]), parseFloat(arry[3])];
            }
            dev.MapLoad.AddWMSLayer(param);
            var initExtent = param.Extent;
            if (dev.App.Config.SystemMap.DataEPSG != dev.App.Config.SystemMap.DisplayEPSG) initExtent = ol.proj.transformExtent(initExtent, dev.App.Config.SystemMap.DataEPSG, dev.App.Config.SystemMap.DisplayEPSG);
            dev.App.Map.getView().fit(initExtent, dev.App.Map.getSize());
            dev.App.Map.getView().setZoom(parseInt(layerinfo.Zoom));
            dev.Map3DUtils.SetView([param.Extent[0], param.Extent[1]], [param.Extent[2], param.Extent[3]]);
        }
        function detailedclick(evt, sql) {
            if (!dev.IsNull(sql)) {
                var param = {
                    ID: "crop",
                    Url: dev.MapLoad.GetUrlByRelID(cropl.WFSUrl),
                    TypeName: cropl.TypeName,
                    SrsName: exMap.getView().getProjection().getCode(),
                    CqlFilter: "1=1 AND MASSIFID='" + sql + "'",
                    Async: false
                };
                var query = new dev.SWFS_H();
                query.Target.bind("onQueryCompleted", function (s, e) {
                    if (e.statusCode == 200 && !dev.IsNull(e.data) && e.data.length > 0) {
                        prop = e.data[0].getProperties();
                    }
                });
                query.Query(param);
            }
            else {
                var result = dev.SPointerQuery({
                    Url: dev.MapLoad.GetUrlByRelID(cropl.WFSUrl),
                    TypeName: cropl.TypeName,
                    Point: evt,
                    SrsName: exMap.getView().getProjection().getCode(),
                    GeometryName: cropl.GeomField,
                    Map: exMap,
                    PX: 2
                });
                if (dev.IsNull(result) || result.length == 0) return;
                if (!dev.IsNull(polygonkey)) {
                    exMap.unByKey(polygonkey);
                    polygonkey = null;
                }
                prop = result[0].getProperties();
            }
            var feature = new ol.Feature({ id: "fine" + new Date().getTime(), geometry: prop.geometry });
            polygonkey = dev.MapUtils.LineSymbolStyle(feature, exMap, null, false);
            var extent = feature.getGeometry().getExtent();
            exMap.getView().centerOn([((extent[0] + extent[2]) / 2), ((extent[1] + extent[3]) / 2)],
            exMap.getSize(), [exMap.getSize()[0] / 2, exMap.getSize()[1] / 2], 10);
            exMap.getView().setZoom(16);
            if (!dev.IsNull(mas))
                mas.remove();
            if (!dev.IsNull(framer))
                framer.remove();
            if (!dev.IsNull(hist))
                hist.remove();
            mas = $('<table></table>').appendTo($('#massifdiv'));
            $('<tr><td>地块编号</td><td>' + prop.MASSIFID + '</td><tr>').appendTo(mas);
            $('<tr><td>地类名称</td><td>' + prop.CLASSNAME + '</td><tr>').appendTo(mas);
            $('<tr><td>耕地类型</td><td>' + prop.LANDTYPE + '</td><tr>').appendTo(mas);
            $('<tr><td>地块面貌</td><td>' + dev.SqrtMetersToMu(prop.FARMAREA, 2) + '亩</td><tr>').appendTo(mas);
            $('<tr><td>详细地址</td><td>' + prop.PROVINCE + prop.TOWN + '</td><tr>').appendTo(mas);
            $('#bgimg').css('background', '');
            $.ajax({
                type: "POST",
                contentType: "application/json",
                data: "\"ID\"='" + prop.FARMERID + "'",
                url: dev.MapLoad.GetUrlByRelID("Service") + "farmer/getbyfilter",
                success: function (response) {
                    if (dev.IsNull(response.data) || response.data.length == 0) {
                        $('#bgimg').css('background', 'url("../image/authorization/default.jpg") no-repeat center/100% 100%');
                        return;
                    }
                    if (!dev.IsNull(response.data[0].attid))
                        loadHeadPic(response.data[0].attid);
                    else
                        $('#bgimg').css('background', 'url("../image/authorization/default.jpg") no-repeat center/100% 100%');
                    framer = $('<table></table>').appendTo($('#framerdiv'));
                    var csrd = response.data[0].cardid;
                    var mobile = response.data[0].mobilephone;
                    if (!isadmin) {
                        csrd = dev.simpleencryp(response.data[0].cardid);
                        mobile = dev.simpleencryp(response.data[0].mobilephone);
                    }
                    $('<tr><td>身份证号</td><td>' + csrd + '</td><tr>').appendTo(framer);
                    $('<tr><td>联系电话</td><td>' + mobile + '</td><tr>').appendTo(framer);
                },
                error: function (e) {
                }
            })
            $.ajax({
                type: "POST",
                data: { massifId: prop.MASSIFID },
                url: dev.MapLoad.GetUrlByRelID("Service") + "crop/findCropByMassifId",
                success: function (response) {
                    if (dev.IsNull(response.data) || response.data.length == 0) {
                        return;
                    }
                    rsp = response.data;
                    hist = $('<table></table>').appendTo($('#histroydiv'));
                    for (var i = 0; i < rsp.length; i++) {
                        if (i > 2)
                            return;
                        var src;
                        if (dev.IsNull(rsp[i].path[0])) {
                            src = "暂无图片";
                        }
                        else {
                            src = '<img height="26px" width="38px"  src="' + rsp[i].path[0] + '"></img>';
                        }
                        var tb = $('<tr><td>' + dev.GetDateString(rsp[i].cropTypeEntity.cropdate, true) + '</td><td>' + rsp[i].cropTypeEntity.croptype + '</td><td onclick="cropimg(\'' + i + '\')" style="text-align: left;padding-top:0;">' + src + '</td><tr>').appendTo(hist);
                    }
                },
                error: function (e) {
                }
            })
            //初始化土壤数据
            soilHistory();
            //初始化产量数据
            yieldHistory();
            //施肥数据
            fertilityHistory();
            //病虫害数据
            pestsHistory();
            //长势数据
            growthHistory();
        }
        //加载头像
        function loadHeadPic(attid) {
            var url = dev.MapLoad.GetUrlByRelID("Service") + "file/att/" + attid;
            $.ajax({
                url: url,
                type: "GET",
                contentType: 'application/json',
                success: function (result) {
                    if (result.statusCode != 200 || dev.IsNull(result.data)) return;
                    var piclist = result.data;
                    if (!dev.IsNull(piclist) && piclist.length > 0) {
                        $('#bgimg').css('background', 'url(' + piclist[0].path + ') no-repeat center/100% 100%');
                    }
                }
            });
        }
        function getUrlParam(name) {
            var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)"); //构造一个含有目标参数的正则表达式对象
            var r = window.location.search.substr(1).match(reg);  //匹配目标参数
            if (r != null) return unescape(r[2]); return null; //返回参数值
        }
        function soilHistory() {
            $.ajax({
                type: "POST",
                data: { massifId: prop.MASSIFID, region: cropl.CountyCode },
                url: dev.MapLoad.GetUrlByRelID("Service") + "soil/findHistoryArea",
                success: function (response) {
                    if (dev.IsNull(response.data)) {
                        return;
                    }
                    totalChart(response.data);
                },
                error: function (e) {
                }
            })
        }
        function totalChart(sdata) {
            var series1 = [{ name: "过多", data: [], type: "column", color: '#00FFFF' },
                { name: "适宜", data: [], type: 'column', color: "#00FF00" },
                { name: "不足", data: [], type: 'column', color: "#0000ff" },
                { name: "轻旱", data: [], type: 'column', color: "#FFFF00" },
            { name: "中旱", data: [], type: 'column', color: "#E27000" },
            { name: "重旱", data: [], type: 'column', color: "#7D4000" },
            { name: "极旱", data: [], type: 'column', color: "#FF0000" }
            ];
            $(".title", $(".rightpane1")).text("历年土壤墒情等级面积(亩)");
            var series2 = [];
            var monitordate = [];
            var m = Enumerable.From(sdata).OrderBy('s=>s.CROPDATE').GroupBy('s=>s.CROPDATE').ToArray();
            for (var i = 0; i < m.length; i++) {
                monitordate.push(m[i].source[0].CROPDATE);
                if (i < 3) {
                    var sum = Enumerable.From(m[i]).Where('s=>s.GRIDCODE==2').ToArray();
                    var gridv = sum.length == 0 ? 0 : sum[0].AREA;
                    var sumfer = parseFloat(dev.SqrtMetersToMu(gridv * 1000000, 1))
                    $("#attr" + (i + 10), $(".rightpane1")).html("<span style='font-size:15px;line-height: calc(250% - 10px);color:#7B68EE'>适宜：" + sumfer + "</span></br><span style='font-size:12px;color:#FFFFFF'>" + m[i].source[0].CROPDATE + "</span>");
                }
            }
            var griddata = Enumerable.From(sdata).OrderBy('s=>s.GRIDCODE').GroupBy('s=>s.GRIDCODE').ToArray();
            for (var i = 0; i < griddata.length; i++) {
                var currseries = { name: series1[griddata[i].source[0].GRIDCODE - 1].name, data: [], color: series1[griddata[i].source[0].GRIDCODE - 1].color };
                var mdata = Enumerable.From(griddata[i].source).OrderBy('s=>s.CROPDATE').GroupBy('s=>s.CROPDATE').ToArray();
                for (var j = 0; j < monitordate.length; j++) {
                    var soilname = Enumerable.From(mdata).Where('s=>s.source[0].CROPDATE=="' + monitordate[j] + '"').ToArray();
                    if (soilname.length > 0) {
                        var soilnum = Enumerable.From(soilname).Sum('s=>s.source[0].AREA');
                        currseries.data[j] = { y: parseFloat(dev.SqrtMetersToMu(soilnum * 1000000, 1)) };
                    }
                    else {
                        currseries.data[j] = { y: 0 };
                    }
                }
                series2.push(currseries);
            }
            hchart = {
                chart: {
                    borderWidth: 0,
                    backgroundColor: 'rgba(4,155,199,0)',
                    type: 'column',
                    style: {
                        color: "#FFFFFF"
                    }
                },
                title: {
                    text: ''
                },
                xAxis: [{
                    type: 'category',
                    labels: {
                        style: {
                            color: '#FFFFFF', fontSize: '9px'
                        }
                    },
                    lineColor: '#000000',
                    categories: monitordate,
                    tickLength: 0,
                    crosshair: true
                }],
                yAxis: [{
                    min: 0,
                    title: {
                        text: '面积（亩）',
                        style: {
                            color: "#000000",
                        }
                    },
                    labels: {
                        style: {
                            color: '#FFFFFF'
                        }
                    },
                    gridLineWidth: 0,
                    gridLineColor: '#000000',
                    lineColor: '#000000',
                    lineWidth: 0.8,
                    tickAmount: 5
                }],
                legend: { itemStyle: { color: '#FFFFFF' }, padding: 2, margin: 1, itemMarginBottom: 0 },
                tooltip: {
                    headerFormat: '<span style="font-size:10px">{point.key}</span><table width="100px";>',
                    pointFormat: '<tr><td style="font-size:12px;color:{series.color};padding:0">{series.name}: </td>' +
                    '<td style="font-size:12px;padding:0;color:black"><b>{point.y:.1f} 亩</b></td></tr>',
                    footerFormat: '</table>',
                    shared: true,
                    useHTML: true
                },
                plotOptions: {
                    column: {
                        borderWidth: 0,
                        cursor: 'pointer'
                    }

                },
                series: series2,
                credits: { enabled: false }
            };
            $('#colum5').highcharts(hchart);
        }
        function yieldHistory() {
            $.ajax({
                type: "POST",
                data: { massifId: prop.MASSIFID, region: cropl.CountyCode },
                url: dev.MapLoad.GetUrlByRelID("Service") + "yield/findHistoryAvg",
                success: function (response) {
                    if (dev.IsNull(response.data)) {
                        return;
                    }
                    yieldChart(response.data);
                },
                error: function (e) {
                }
            })
        }
        function yieldChart(sdata) {
            $(".title", $(".rightpane2")).text("历年农作物平均产量(kg)");
            var series12 = [];
            var xvalue = [];
            for (var i = 0; i < sdata.length; i++) {
                var currseries = { name: sdata[i].CROPDATE, y: parseFloat(sdata[i].AVERAGE.toFixed(2)) };
                xvalue.push(sdata[i].CROPDATE);
                series12.push(currseries);
                if (i < 3) {
                    $("#Div" + (i + 1), $(".rightpane2")).html("<span style='font-size:15px;line-height: calc(250% - 10px);color:#7B68EE'>" + parseFloat(sdata[i].AVERAGE.toFixed(2)) + "</span></br><span style='font-size:12px;color:#FFFFFF'>" + sdata[i].CROPDATE + "</span>");
                }
            }
            hchart = {
                chart: {
                    borderWidth: 0,
                    backgroundColor: 'rgba(4,155,199,0)',
                    type: 'column',
                    options3d: {
                        enabled: true,
                        alpha: 10,
                        beta: 5,
                        depth: 70,
                        viewDistance: 100,
                        frame: {
                            bottom: {
                                size: 10
                            },
                            side: {
                                size: 1,
                                color: 'transparent'
                            },
                            back: {
                                size: 1,
                                color: 'transparent'
                            }
                        }
                    },
                },
                title: {
                    text: ''
                },
                xAxis: [{
                    categories: xvalue,
                    labels: {
                        style: {
                            color: '#FFFFFF',
                            fontSize: '9px'
                        }
                    },
                    gridLineWidth: 1,
                    gridLineColor: 'rgba(100,149,237,0.5)',
                    crosshair: true
                }],
                yAxis: [{
                    min: 0,
                    title: {
                        text: '',
                        style: {
                            color: "#000000",
                        }
                    },
                    labels: {
                        style: {
                            color: '#FFFFFF'
                        }
                    },
                    gridLineWidth: 1,
                    gridLineColor: 'rgba(100,149,237,0.5)',
                }],
                legend: {
                    enabled: false
                },
                plotOptions: {
                    series: {
                        borderWidth: 0,
                        dataLabels: {
                            enabled: true,
                            format: '{point.y:.2f}',
                            color: '#FFFFFF'
                        }
                    }
                },
                tooltip: {
                    headerFormat: '',
                    pointFormat: '<span>{point.name}</span>: <b>{point.y:.2f}kg</b>'
                },
                series: [{
                    data: series12
                }],
                credits: { enabled: false }
            };
            var ychart = Highcharts.chart('colum6', hchart);
            var i = 0;
            if (!dev.IsNull(Interval1)) { clearInterval(Interval1); Interval1 = null; }
            Interval1 = setInterval(function () {
                if (i === ychart.series[0].data.length) {
                    i = 0;
                }
                var points = ychart.series[0].data[i];
                ychart.tooltip.refresh(points);
                i += 1;
            }, 3000);
        }
        function fertilityHistory() {
            $.ajax({
                type: "POST",
                data: { massifId: prop.MASSIFID, region: cropl.CountyCode },
                url: dev.MapLoad.GetUrlByRelID("Service") + "fertility/findHistoryArea",
                success: function (response) {
                    if (dev.IsNull(response.data)) {
                        return;
                    }
                    fertilityChart(response.data);
                },
                error: function (e) {
                }
            })
        }
        function fertilityChart(sdata) {
            var series6 = [{ name: "极高", data: [], type: "column", color: '#00FF00' },
                { name: "高", data: [], type: 'column', color: "#00A884" },
                { name: "中", data: [], type: 'column', color: "#22F1E0" },
                { name: "低", data: [], type: 'column', color: "#FFAA01" },
                { name: "极低", data: [], type: 'column', color: "#FF0000" }
            ];
            $(".title", $(".rightpane3")).text("历年农作物施肥等级面积(亩)");
            var series7 = [];
            var fertilitydate = [];
            var m = Enumerable.From(sdata).OrderBy('s=>s.CROPDATE').GroupBy('s=>s.CROPDATE').ToArray();
            for (var i = 0; i < m.length; i++) {
                fertilitydate.push(m[i].source[0].CROPDATE);
                if (i < 3) {
                    var sum = Enumerable.From(m[i]).Where('s=>s.GRIDCODE==1').ToArray();
                    var gridv = sum.length == 0 ? 0 : sum[0].AREA;
                    var sumfer = parseFloat(dev.SqrtMetersToMu(gridv * 1000000, 1))
                    $("#attr" + (i + 1), $(".rightpane3")).html("<span style='font-size:15px;line-height: calc(250% - 10px);color:#7B68EE'>极高：" + sumfer + "</span></br><span style='font-size:12px;color:#FFFFFF'>" + m[i].source[0].CROPDATE + "</span>");
                }
            }

            var griddata = Enumerable.From(sdata).OrderBy('s=>s.GRIDCODE').GroupBy('s=>s.GRIDCODE').ToArray();
            for (var i = 0; i < griddata.length; i++) {
                var currseries = { name: series6[griddata[i].source[0].GRIDCODE - 1].name, data: [], color: series6[griddata[i].source[0].GRIDCODE - 1].color };
                var mdata = Enumerable.From(griddata[i].source).OrderBy('s=>s.CROPDATE').GroupBy('s=>s.CROPDATE').ToArray();
                for (var j = 0; j < fertilitydate.length; j++) {
                    var fertilityname = Enumerable.From(mdata).Where('s=>s.source[0].CROPDATE=="' + fertilitydate[j] + '"').ToArray();
                    if (fertilityname.length > 0) {
                        var fertilitynum = Enumerable.From(fertilityname).Sum('s=>s.source[0].AREA');
                        currseries.data[j] = { y: parseFloat(dev.SqrtMetersToMu(fertilitynum * 1000000, 1)) };
                    }
                    else {
                        currseries.data[j] = { y: 0 };
                    }
                }
                series7.push(currseries);
            }
            hchart = {
                chart: {
                    borderWidth: 0,
                    backgroundColor: 'rgba(4,155,199,0)',
                    type: 'column',
                    style: {
                        color: "#FFFFFF"
                    }
                },
                title: {
                    text: ''
                },
                xAxis: [{
                    type: 'category',
                    labels: {
                        style: {
                            color: '#FFFFFF', fontSize: '9px'
                        }
                    },
                    lineColor: '#000000',
                    categories: fertilitydate,
                    tickLength: 0,
                    crosshair: true
                }],
                yAxis: [{
                    min: 0,
                    title: {
                        text: '面积（亩）',
                        style: {
                            color: "#000000",
                        }
                    },
                    labels: {
                        style: {
                            color: '#FFFFFF'
                        }
                    },
                    gridLineWidth: 0,
                    gridLineColor: '#000000',
                    lineColor: '#000000',
                    lineWidth: 0.8,
                    tickAmount: 5
                }],
                legend: { itemStyle: { color: '#FFFFFF' }, padding: 2, margin: 1, itemMarginBottom: 0 },
                tooltip: {
                    headerFormat: '<span style="font-size:10px">{point.key}</span><table width="100px";>',
                    pointFormat: '<tr><td style="font-size:12px;color:{series.color};padding:0">{series.name}: </td>' +
                    '<td style="font-size:12px;padding:0;color:black"><b>{point.y:.1f} 亩</b></td></tr>',
                    footerFormat: '</table>',
                    shared: true,
                    useHTML: true
                },
                plotOptions: {
                    column: {
                        borderWidth: 0,
                        cursor: 'pointer'
                    }

                },
                series: series7,
                credits: { enabled: false }
            };
            $('#colum2').highcharts(hchart);
        }
        function pestsHistory() {
            $.ajax({
                type: "POST",
                data: { massifId: prop.MASSIFID, region: cropl.CountyCode },
                url: dev.MapLoad.GetUrlByRelID("Service") + "pests/findHistoryArea",
                success: function (response) {
                    if (dev.IsNull(response.data)) {
                        return;
                    }
                    pestsChart(response.data);
                },
                error: function (e) {
                }
            })
        }
        function pestsChart(sdata) {
            var series8 = [{ name: "健康", data: [], type: "column", color: '#00FF00' },
                { name: "轻微", data: [], type: 'column', color: "#FAF402" },
                { name: "中等", data: [], type: 'column', color: "#FF7F02" },
                { name: "严重", data: [], type: 'column', color: "#FF0000" }
            ];
            $(".title", $(".leftpanel2")).text("历年农作物病虫害等级面积(亩)");
            var series9 = [];
            var pestsdate = [];
            var m = Enumerable.From(sdata).OrderBy('s=>s.CROPDATE').GroupBy('s=>s.CROPDATE').ToArray();
            for (var i = 0; i < m.length; i++) {
                pestsdate.push(m[i].source[0].CROPDATE);
                if (i < 3) {
                    var sum = Enumerable.From(m[i]).Where('s=>s.GRIDCODE==1').ToArray();
                    var gridv = sum.length == 0 ? 0 : sum[0].AREA;
                    var sumfer = parseFloat(dev.SqrtMetersToMu(gridv * 1000000, 1))
                    $("#attr" + (i + 4), $(".leftpanel2")).html("<span style='font-size:15px;line-height: calc(250% - 10px);color:#7B68EE'>健康：" + sumfer + "</span></br><span style='font-size:12px;color:#FFFFFF'>" + m[i].source[0].CROPDATE + "</span>");
                }
            }

            var griddata = Enumerable.From(sdata).OrderBy('s=>s.GRIDCODE').GroupBy('s=>s.GRIDCODE').ToArray();
            for (var i = 0; i < griddata.length; i++) {
                var currseries = { name: series8[griddata[i].source[0].GRIDCODE - 1].name, data: [], color: series8[griddata[i].source[0].GRIDCODE - 1].color };
                var mdata = Enumerable.From(griddata[i].source).OrderBy('s=>s.CROPDATE').GroupBy('s=>s.CROPDATE').ToArray();
                for (var j = 0; j < pestsdate.length; j++) {
                    var pestsname = Enumerable.From(mdata).Where('s=>s.source[0].CROPDATE=="' + pestsdate[j] + '"').ToArray();
                    if (pestsname.length > 0) {
                        var pestsnum = Enumerable.From(pestsname).Sum('s=>s.source[0].AREA');
                        currseries.data[j] = { y: parseFloat(dev.SqrtMetersToMu(pestsnum * 1000000, 1)) };
                    }
                    else {
                        currseries.data[j] = { y: 0 };
                    }
                }
                series9.push(currseries);
            }
            hchart = {
                chart: {
                    borderWidth: 0,
                    backgroundColor: 'rgba(4,155,199,0)',
                    type: 'column',
                    style: {
                        color: "#FFFFFF"
                    }
                },
                title: {
                    text: ''
                },
                xAxis: [{
                    type: 'category',
                    labels: {
                        style: {
                            color: '#FFFFFF', fontSize: '9px'
                        }
                    },
                    gridLineWidth: 0,
                    gridLineColor: 'rgba(70,130,180,0.8)',
                    lineColor: '#00008B',
                    categories: pestsdate,
                    tickLength: 0,
                    crosshair: true
                }],
                yAxis: [{
                    min: 0,
                    title: {
                        text: '面积（亩）',
                        style: {
                            color: "#000000",
                        }
                    },
                    labels: {
                        style: {
                            color: '#FFFFFF'
                        }
                    },
                    gridLineWidth: 0,
                    gridLineColor: 'rgba(70,130,180,0.8)',
                    lineColor: '#00008B',
                    lineWidth: 0.8,
                    tickAmount: 5
                }],
                legend: { itemStyle: { color: '#FFFFFF' }, padding: 2, margin: 1, itemMarginBottom: 0 },
                tooltip: {
                    headerFormat: '<span style="font-size:10px">{point.key}</span><table width="100px";>',
                    pointFormat: '<tr><td style="font-size:12px;color:{series.color};padding:0">{series.name}: </td>' +
                    '<td style="font-size:12px;padding:0;color:black"><b>{point.y:.1f} 亩</b></td></tr>',
                    footerFormat: '</table>',
                    shared: true,
                    useHTML: true
                },
                plotOptions: {
                    column: {
                        borderWidth: 0,
                        cursor: 'pointer'
                    }

                },
                series: series9,
                credits: { enabled: false }
            };
            $('#colum3').highcharts(hchart);
        }
        function growthHistory() {
            $.ajax({
                type: "POST",
                data: { massifId: prop.MASSIFID, region: cropl.CountyCode },
                url: dev.MapLoad.GetUrlByRelID("Service") + "growth/findHistoryArea",
                success: function (response) {
                    if (dev.IsNull(response.data)) {
                        return;
                    }
                    growthChart(response.data);
                },
                error: function (e) {
                }
            })
        }
        function growthChart(sdata) {
            var series10 = [{ name: "长势好", data: [], type: "column", color: '#0000ff' },
                { name: "长势持平", data: [], type: 'column', color: "#00ff00" },
                { name: "长势差", data: [], type: 'column', color: "#ff0000" }
            ];
            $(".title", $(".leftpanel3")).text("历年农作物长势等级面积(亩)");
            var series11 = [];
            var growthdate = [];
            var m = Enumerable.From(sdata).OrderBy('s=>s.CROPDATE').GroupBy('s=>s.CROPDATE').ToArray();
            for (var i = 0; i < m.length; i++) {
                growthdate.push(m[i].source[0].CROPDATE);
                if (i < 3) {
                    var sum = Enumerable.From(m[i]).Where('s=>s.GRIDCODE==1').ToArray();
                    var gridv = sum.length == 0 ? 0 : sum[0].AREA;
                    var sumfer = parseFloat(dev.SqrtMetersToMu(gridv * 1000000, 1))
                    $("#attr" + (i + 13), $(".leftpanel3")).html("<span style='font-size:15px;line-height: calc(250% - 10px);color:#7B68EE'>长势好：" + sumfer + "</span></br><span style='font-size:12px;color:#FFFFFF'>" + m[i].source[0].CROPDATE + "</span>");
                }
            }
            var griddata = Enumerable.From(sdata).OrderBy('s=>s.GRIDCODE').GroupBy('s=>s.GRIDCODE').ToArray();
            for (var i = 0; i < griddata.length; i++) {
                var currseries = { name: series10[griddata[i].source[0].GRIDCODE - 1].name, data: [], color: series10[griddata[i].source[0].GRIDCODE - 1].color };
                var mdata = Enumerable.From(griddata[i].source).OrderBy('s=>s.CROPDATE').GroupBy('s=>s.CROPDATE').ToArray();
                for (var j = 0; j < growthdate.length; j++) {
                    var growthname = Enumerable.From(mdata).Where('s=>s.source[0].CROPDATE=="' + growthdate[j] + '"').ToArray();
                    if (growthname.length > 0) {
                        var growthnum = Enumerable.From(growthname).Sum('s=>s.source[0].AREA');
                        currseries.data[j] = { y: parseFloat(dev.SqrtMetersToMu(growthnum * 1000000, 1)) };
                    }
                    else {
                        currseries.data[j] = { y: 0 };
                    }
                }
                series11.push(currseries);
            }
            hchart = {
                chart: {
                    borderWidth: 0,
                    backgroundColor: 'rgba(4,155,199,0)',
                    type: 'spline',
                    style: {
                        color: "#FFFFFF"
                    }
                },
                title: {
                    text: ''
                },
                xAxis: [{
                    type: 'category',
                    labels: {
                        style: {
                            color: '#FFFFFF',
                            fontSize: '8px'
                        }
                    },
                    lineColor: '#000000',
                    categories: growthdate,
                    tickLength: 0,
                    crosshair: true
                }],
                yAxis: [{
                    min: 0,
                    title: {
                        text: '',
                        style: {
                            color: "#000000",
                        }
                    },
                    labels: {
                        style: {
                            color: '#FFFFFF'
                        }
                    },
                    gridLineWidth: 0,
                    gridLineColor: '#000000',
                    lineColor: '#000000',
                    lineWidth: 0.8,
                    tickAmount: 5
                }],
                legend: { itemStyle: { color: '#FFFFFF' }, padding: 2, margin: 1, itemMarginBottom: 0 },
                tooltip: {
                    borderColor: '#FFFFFF',
                    backgroundColor: 'rgba(135,206,250,0.8)',
                    borderRadius: 20,
                    borderWidth: 0,
                    headerFormat: '<span style="font-size:10px">{point.key}</span><table width="120px";>',
                    pointFormat: '<tr><td style="width:45%;font-size:12px;color:#FFFFFF;padding:0">{series.name}: </td>' +
                    '<td style="font-size:12px;padding:0;color:black"><b>{point.y:.1f} 亩</b></td></tr>',
                    footerFormat: '</table>',
                    shared: true,
                    useHTML: true
                },
                plotOptions: {
                    spline: {
                        borderWidth: 0,
                        cursor: 'pointer'
                    }

                },
                series: series11,
                credits: { enabled: false }
            };
            $('#colum4').highcharts(hchart);
        }
        //获取所有监测站点
        function showmonitor(data) {
            if (dev.IsNull(data) || data.length == 0) return;
            var features = [];
            for (var i = 0; i < data.length; i++) {
                var x = data[i].longitude;
                var y = data[i].latitude;
                var currfeature = new ol.Feature(new ol.geom.Point([parseFloat(x), parseFloat(y)]));
                currfeature.set("serialnumber", data[i].serialnumber);
                currfeature.set("indepeid", data[i].indepeid);
                currfeature.setStyle(new ol.style.Style({
                    image: new ol.style.Icon({ src: GetRootPath() + "show/showimg/mpoint.png" }),
                    text: new ol.style.Text({ text: data[i].no, font: "15px serif", offsetX: 5, offsetY: -20, fill: new ol.style.Fill({ color: [255, 255, 255, 1] }) })
                }));
                features.push(currfeature);
            }
            dev.MapUtils.ClearAndAddFeatures(features, "tempGraphicLayer", null, exMap);
        }
        //显示图片
        function cropimg(i) {
            dev.PreViewPics(rsp[i].path, 0, $('.content').parent());
        }
        //辅助函数
        function featureclear() {
            dev.MapUtils.ClearFeature("tempGraphicLayer", exMap);
        }
        function getlayertreebyType(type) {
            var layertree = [];
            if (dev.IsNull(layerconfig)) return null;
            if (dev.IsNull(layerconfig.length)) layertree = [dev.ObjClone(layerconfig)];
            else layertree = layerconfig.clone();
            //首先找到根级节点为该类型的
            layertree = Enumerable.From(layertree).Where('s=>s.Type.indexOf("' + type + '")>=0').ToArray();
            getnodebytype(layertree, type);
            return layertree;
        }
        function getnodebytype(nodes, type) {
            if (dev.IsNull(nodes) || dev.IsNull(type)) return;
            for (var i = 0; i < nodes.length; i++) {
                if (dev.IsNull(nodes[i].Child)) continue;
                if (dev.IsNull(nodes[i].Child.length)) nodes[i].Child = [nodes[i].Child];
                if (!dev.IsNull(nodes[i].Child) && nodes[i].Child.length > 0) getnodebytype(nodes[i].Child, type);
            }
        }
    </script>
</head>

<body id="flow" style="margin: 0;">
    <div class="content" style="min-height: 870px; min-width: 1300px;">
        <div id="information">
            <div id="infobtn" style="width: 134px; height: 50px; left: 2px; cursor: pointer; background: url(showimg/backhome.png) no-repeat center/100% 100%;"></div>
            <div style="width: 80px; height: 80px; margin-left: calc(50%  - 40px); background: url(showimg/head.png) no-repeat center/100% 100%;">
                <div id="bgimg" style="width: 90%; height: 90%; margin: 0 auto; top: 5%; position: relative; border-radius: 50%;"></div>
            </div>
            <div style="width: 2px; height: 1%; margin: 0 auto; position: relative; border: 10px solid transparent; top: -2%; border-bottom-color: #6495ED;"></div>
            <div style="width: 98%; height: calc(97% - 130px); margin: 0 auto; position: relative; border: 1px solid #0a6d5b; top: -2%; border-radius: 5px">
                <div id="framer" style="width: 100%; height: 24%; border-bottom: 1px solid #0a6d5b; position: relative; background-color: transparent">
                    <div id="fdiv" class="tldiv">&nbsp农户信息</div>
                    <div id="framerdiv" style="width: 100%; height: 75%;"></div>
                </div>
                <div id="massif" style="width: 100%; height: 43%; border-bottom: 1px solid #0a6d5b; position: relative; background-color: transparent">
                    <div id="Div4" class="tldiv" style="height: 16%">&nbsp地块信息</div>
                    <div id="massifdiv" style="width: 100%; height: 75%;"></div>
                </div>
                <div id="histroy" style="width: 100%; height: 33%; position: relative; background-color: transparent">
                    <div id="Div5" class="tldiv" style="height: 25%">&nbsp历史种植</div>
                    <div id="histroydiv" style="width: 100%; height: 75%;"></div>
                </div>
            </div>
        </div>
        <div class="leftpanel">
            <div class="title"></div>
            <div class="mappanel">
                <div class="mappaneldom"></div>
                <div class="mappanel3d"></div>
            </div>
        </div>
        <div class="rightpane1" style="width: 30%; height: calc(30% - 40px);">
            <div class="title"></div>
            <div class="attribute">
                <div id="attr10" class="attribute1"></div>
                <div id="attr11" class="attribute1"></div>
                <div id="attr12" class="attribute1"></div>
            </div>
            <div id="colum5" class="columdiv1"></div>
        </div>
        <div class="rightpane2" style="width: 30%; height: calc(30% - 40px); margin-top: 19px">
            <div class="title"></div>
            <div class="attribute">
                <div id="Div1" class="attribute1"></div>
                <div id="Div2" class="attribute1"></div>
                <div id="Div3" class="attribute1"></div>
            </div>
            <div id="colum6" class="columdiv1"></div>
        </div>
        <div class="leftpanel2" style="width: 28%; height: calc(33% - 40px); margin-top: 19px">
            <div class="title"></div>
            <div class="attribute">
                <div id="attr4" class="attribute1"></div>
                <div id="attr5" class="attribute1"></div>
                <div id="attr6" class="attribute1"></div>
            </div>
            <div id="colum3" class="columdiv1"></div>
        </div>
        <div class="leftpanel3" style="width: 37%; height: calc(33% - 40px); margin-top: 19px">
            <div class="title"></div>
            <div class="attribute">
                <div id="attr13" class="attribute1"></div>
                <div id="attr14" class="attribute1"></div>
                <div id="attr15" class="attribute1"></div>
            </div>
            <div id="colum4" class="columdiv1"></div>
        </div>
        <div class="rightpane3" style="width: 30%; height: calc(33% - 40px); margin-top: 19px">
            <div class="title"></div>
            <div class="attribute">
                <div id="attr1" class="attribute1"></div>
                <div id="attr2" class="attribute1"></div>
                <div id="attr3" class="attribute1"></div>
            </div>
            <div id="colum2" class="columdiv1"></div>
        </div>
    </div>
    <div class="fillpanel"></div>
    <footer>
        Copyright&nbsp;©&nbsp;2017-2020&nbsp;&nbsp;北京禾壮慧农科技发展有限公司&nbsp;&nbsp;版权所有
    </footer>
</body>
</html>
